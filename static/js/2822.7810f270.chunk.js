(self.webpackChunk_kne_components_leapin_ai_agent=self.webpackChunk_kne_components_leapin_ai_agent||[]).push([[2822],{27113:(e,t,n)=>{var r;!function(){var a="object"==typeof window&&!!window.document,o=a?window:Object;!function(e,t){"use strict";var n=function(){},r=function(e){return"number"==typeof e},a=function(e){return JSON.stringify(e)},o=function(e){return new O(e)},s=o.LM="2025-01-11 09:28",i="https://github.com/xiangyuecn/Recorder",c="Recorder",f="getUserMedia",u="srcSampleRate",l="sampleRate",v="bitRate",p="catch",h=e[c];if(h&&h.LM==s)return void h.CLog(h.i18n.$T("K8zP::\u91cd\u590d\u5bfc\u5165{1}",0,c),3);o.IsOpen=function(){var e=o.Stream;if(e){var t=L(e)[0];if(t){var n=t.readyState;return"live"==n||n==t.LIVE}}return!1},o.BufferSize=4096,o.Destroy=function(){for(var e in T(c+" Destroy"),M(),g)g[e]()};var g={};o.BindDestroy=function(e,t){g[e]=t},o.Support=function(){if(!t)return!1;var e=navigator.mediaDevices||{};return e[f]||(e=navigator)[f]||(e[f]=e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia),!!e[f]&&(o.Scope=e,!!o.GetContext())},o.GetContext=function(e){if(!t)return null;var n=window.AudioContext;if(n||(n=window.webkitAudioContext),!n)return null;var r=o.Ctx,a=0;return r||(r=o.Ctx=new n,a=1,o.NewCtxs=o.NewCtxs||[],o.BindDestroy("Ctx",(function(){var e=o.Ctx;e&&e.close&&(d(e),o.Ctx=0);var t=o.NewCtxs;o.NewCtxs=[];for(var n=0;n<t.length;n++)d(t[n])}))),e&&r.close&&(a||(r._useC||d(r),r=new n),r._useC=1,o.NewCtxs.push(r)),r},o.CloseNewCtx=function(e){if(e&&e.close){d(e);for(var t=o.NewCtxs||[],n=t.length,r=0;r<t.length;r++)if(t[r]==e){t.splice(r,1);break}T(G("mSxV::\u5269{1}\u4e2aGetContext\u672aclose",0,n+"-1="+t.length),t.length?3:0)}};var d=function(e){if(e&&e.close&&!e._isC&&(e._isC=1,"closed"!=e.state))try{e.close()}catch(t){T("ctx close err",1,t)}},m=o.ResumeCtx=function(e,t,n,r){var a=0,o=0,s=0,i=0,c="EventListener",f="ResumeCtx ",u=function(t,f){o&&l(),a||(a=1,t&&r(t,i),f&&n(i)),f&&(!e._LsSC&&e["add"+c]&&e["add"+c]("statechange",v),e._LsSC=1,s=1)},l=function(e){if(!e||!o){o=e?1:0;for(var t=["focus","mousedown","mouseup","touchstart","touchend"],n=0;n<t.length;n++)window[(e?"add":"remove")+c](t[n],v,!0)}},v=function(){var n=e.state,r=C(n);if(!a&&!t(r?++i:i))return u();r?(s&&T(f+"sc "+n,3),l(1),e.resume().then((function(){s&&T(f+"sc "+e.state),u(0,1)}))[p]((function(t){T(f+"error",1,t),C(e.state)||u(t.message||"error")}))):"closed"==n?(s&&!e._isC&&T(f+"sc "+n,1),u("ctx closed")):u(0,1)};v()},C=o.CtxSpEnd=function(e){return"suspended"==e||"interrupted"==e},_=function(e){var t=e.state,n="ctx.state="+t;return C(t)&&(n+=G("nMIy::\uff08\u6ce8\u610f\uff1actx\u4e0d\u662frunning\u72b6\u6001\uff0crec.open\u548cstart\u81f3\u5c11\u8981\u6709\u4e00\u4e2a\u5728\u7528\u6237\u64cd\u4f5c(\u89e6\u6478\u3001\u70b9\u51fb\u7b49)\u65f6\u8fdb\u884c\u8c03\u7528\uff0c\u5426\u5219\u5c06\u5728rec.start\u65f6\u5c1d\u8bd5\u8fdb\u884cctx.resume\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u517c\u5bb9\u6027\u95ee\u9898(\u4ec5iOS)\uff0c\u8bf7\u53c2\u9605\u6587\u6863\u4e2drunningContext\u914d\u7f6e\uff09")),n},y="ConnectEnableWebM";o[y]=!0;var w="ConnectEnableWorklet";o[w]=!1;var b=function(e){var t=e.BufferSize||o.BufferSize,n=e.Stream,r=n._c,s=r[l],i={},f=L(n)[0],u=null,v="";if(f&&f.getSettings){var h=(u=f.getSettings())[l];h&&h!=s&&(v=G("eS8i::Stream\u7684\u91c7\u6837\u7387{1}\u4e0d\u7b49\u4e8e{2}\uff0c\u5c06\u8fdb\u884c\u91c7\u6837\u7387\u8f6c\u6362\uff08\u6ce8\u610f\uff1a\u97f3\u8d28\u4e0d\u4f1a\u53d8\u597d\u751a\u81f3\u53ef\u80fd\u53d8\u5dee\uff09\uff0c\u4e3b\u8981\u5728\u79fb\u52a8\u7aef\u672a\u7981\u7528\u56de\u58f0\u6d88\u9664\u65f6\u4f1a\u4ea7\u751f\u6b64\u73b0\u8c61\uff0c\u6d4f\u89c8\u5668\u6709\u56de\u58f0\u6d88\u9664\u65f6\u53ef\u80fd\u53ea\u4f1a\u8fd4\u56de16k\u91c7\u6837\u7387\u7684\u97f3\u9891\u6570\u636e\uff0c",0,h,s))}n._ts=u,T(v+"Stream TrackSet: "+a(u),v?3:0);var g,d,C,_=function(e){var t=n._m=r.createMediaStreamSource(n),a=r.destination,o="createMediaStreamDestination";r[o]&&(a=n._d=r[o]()),t.connect(e),e.connect(a)},b="",S=n._call,M=function(e,t){for(var n in S){if(t!=s){i.index=0;var r=(i=o.SampleData([e],t,s,i,{_sum:1})).data,a=i._sum}else{i={};for(var c=e.length,f=(r=new Int16Array(c),a=0,0);f<c;f++){var u=Math.max(-1,Math.min(1,e[f]));u=u<0?32768*u:32767*u,r[f]=u,a+=Math.abs(u)}}for(var l in S)S[l](r,a);return}},I="ScriptProcessor",A="audioWorklet",R=c+" "+A,O="RecProc",E="MediaRecorder",U=E+".WebM.PCM",z=r.createScriptProcessor||r.createJavaScriptNode,N=G("ZGlf::\u3002\u7531\u4e8e{1}\u5185\u90e81\u79d2375\u6b21\u56de\u8c03\uff0c\u5728\u79fb\u52a8\u7aef\u53ef\u80fd\u4f1a\u6709\u6027\u80fd\u95ee\u9898\u5bfc\u81f4\u56de\u8c03\u4e22\u5931\u5f55\u97f3\u53d8\u77ed\uff0cPC\u7aef\u65e0\u5f71\u54cd\uff0c\u6682\u4e0d\u5efa\u8bae\u5f00\u542f{1}\u3002",0,A),P=function(){d=n.isWorklet=!1,x(n),T(G("7TU0::Connect\u91c7\u7528\u8001\u7684{1}\uff0c",0,I)+F.get(o[w]?G("JwCL::\u4f46\u5df2\u8bbe\u7f6e{1}\u5c1d\u8bd5\u542f\u7528{2}",2):G("VGjB::\u53ef\u8bbe\u7f6e{1}\u5c1d\u8bd5\u542f\u7528{2}",2),[c+"."+w+"=true",A])+b+N,3);var e=n._p=z.call(r,t,1,1);_(e),e.onaudioprocess=function(e){var t=e.inputBuffer.getChannelData(0);M(t,s)}},W=function(){g=n.isWebM=!1,k(n),d=n.isWorklet=!z||o[w];var e=window.AudioWorkletNode;if(d&&r[A]&&e){var a=function(){var e=function(e){return e.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,R)},t="class "+O+" extends AudioWorkletProcessor{";return t+="constructor "+e((function(e){DEL_super(e);var t=this,n=e.processorOptions.bufferSize;t.bufferSize=n,t.buffer=new Float32Array(2*n),t.pos=0,t.port.onmessage=function(e){e.data.kill&&(t.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",e)})),t+="process "+e((function(e,t,n){var r=this,a=r.bufferSize,o=r.buffer,s=r.pos;if((e=(e[0]||[])[0]||[]).length){o.set(e,s);var i=~~((s+=e.length)/a)*a;if(i){this.port.postMessage({val:o.slice(0,i)});var c=o.subarray(i,s);(o=new Float32Array(2*a)).set(c),s=c.length,r.buffer=o}r.pos=s}return!r.kill})),t=(t+='}try{registerProcessor("'+O+'", '+O+')}catch(e){$C.error("'+R+' Reg Error",e)}').replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(t)))},i=function(){return d&&n._na},f=n._na=function(){""!==C&&(clearTimeout(C),C=setTimeout((function(){C=0,i()&&(T(G("MxX1::{1}\u672a\u8fd4\u56de\u4efb\u4f55\u97f3\u9891\uff0c\u6062\u590d\u4f7f\u7528{2}",0,A,I),3),z&&P())}),500))},u=function(){if(i()){var a=n._n=new e(r,O,{processorOptions:{bufferSize:t}});_(a),a.port.onmessage=function(e){C&&(clearTimeout(C),C=""),i()?M(e.data.val,s):d||T(G("XUap::{1}\u591a\u4f59\u56de\u8c03",0,A),3)},T(G("yOta::Connect\u91c7\u7528{1}\uff0c\u8bbe\u7f6e{2}\u53ef\u6062\u590d\u8001\u5f0f{3}",0,A,c+"."+w+"=false",I)+b+N,3)}},l=function(){if(i())if(r[O])u();else{var e=a();r[A].addModule(e).then((function(e){i()&&(r[O]=1,u(),C&&f())}))[p]((function(e){T(A+".addModule Error",1,e),i()&&P()}))}};m(r,(function(){return i()}),l,l)}else P()};(function(){var e=window[E],r="ondataavailable",a="audio/webm; codecs=pcm";g=n.isWebM=o[y];var s=e&&r in e.prototype&&e.isTypeSupported(a);if(b=s?"":G("VwPd::\uff08\u6b64\u6d4f\u89c8\u5668\u4e0d\u652f\u6301{1}\uff09",0,U),g&&s){var i=function(){return g&&n._ra};n._ra=function(){""!==C&&(clearTimeout(C),C=setTimeout((function(){i()&&(T(G("vHnb::{1}\u672a\u8fd4\u56de\u4efb\u4f55\u97f3\u9891\uff0c\u964d\u7ea7\u4f7f\u7528{2}",0,E,A),3),W())}),500))};var f=Object.assign({mimeType:a},o.ConnectWebMOptions),u=n._r=new e(n,f),l=n._rd={};u[r]=function(e){var t=new FileReader;t.onloadend=function(){if(i()){var e=D(new Uint8Array(t.result),l);if(!e)return;if(-1==e)return void W();C&&(clearTimeout(C),C=""),M(e,l.webmSR)}else g||T(G("O9P7::{1}\u591a\u4f59\u56de\u8c03",0,E),3)},t.readAsArrayBuffer(e.data)};try{u.start(~~(t/48)),T(G("LMEm::Connect\u91c7\u7528{1}\uff0c\u8bbe\u7f6e{2}\u53ef\u6062\u590d\u4f7f\u7528{3}\u6216\u8001\u5f0f{4}",0,U,c+"."+y+"=false",A,I))}catch(v){T("mr start err",1,v),W()}}else W()})()},S=function(e){e._na&&e._na(),e._ra&&e._ra()},x=function(e){e._na=null,e._n&&(e._n.port.postMessage({kill:!0}),e._n.disconnect(),e._n=null)},k=function(e){if(e._ra=null,e._r){try{e._r.stop()}catch(t){T("mr stop err",1,t)}e._r=null}},M=function(e){var t=(e=e||o)==o,n=e.Stream;n&&(n._m&&(n._m.disconnect(),n._m=null),!n._RC&&n._c&&o.CloseNewCtx(n._c),n._RC=null,n._c=null,n._d&&(I(n._d.stream),n._d=null),n._p&&(n._p.disconnect(),n._p.onaudioprocess=n._p=null),x(n),k(n),t&&I(n)),e.Stream=0},I=o.StopS_=function(e){for(var t=L(e),n=0;n<t.length;n++){var r=t[n];r.stop&&r.stop()}e.stop&&e.stop()},L=function(e){var t=0,n=0,r=[];e.getAudioTracks&&(t=e.getAudioTracks(),n=e.getVideoTracks()),t||(t=e.audioTracks,n=e.videoTracks);for(var a=0,o=t?t.length:0;a<o;a++)r.push(t[a]);for(a=0,o=n?n.length:0;a<o;a++)r.push(n[a]);return r};o.SampleData=function(e,t,n,r,a){var s="SampleData";r||(r={});var i,c=r.index||0,f=r.offset||0,u=r.raisePrev||0,l=r.filter;(l&&l.fn&&(l.sr&&l.sr!=t||l.srn&&l.srn!=n)&&(l=null,T(G("d48C::{1}\u7684filter\u91c7\u6837\u7387\u53d8\u4e86\uff0c\u91cd\u8bbe\u6ee4\u6ce2",0,s),3)),l)||(l=n<=t?{fn:(i=n>3*t/4?0:n/2*3/4)?o.IIRFilter(!0,t,i):0}:{fn:(i=t>3*n/4?0:t/2*3/4)?o.IIRFilter(!0,n,i):0});l.sr=t,l.srn=n;var v=l.fn,p=r.frameNext||[];a||(a={});var h=a.frameSize||1;a.frameType&&(h="mp3"==a.frameType?1152:1);var g=a._sum,d=0,m=e.length;c>m+1&&T(G("tlbC::{1}\u4f3c\u4e4e\u4f20\u5165\u4e86\u672a\u91cd\u7f6echunk {2}",0,s,c+">"+m),3);for(var C=0,_=c;_<m;_++)C+=e[_].length;var y=t/n;if(y>1)C=Math.max(0,C-Math.floor(f)),C=Math.floor(C/y);else if(y<1){var w=1/y;C=Math.floor(C*w)}C+=p.length;var b=new Int16Array(C),S=0;for(_=0;_<p.length;_++)b[S]=p[_],S++;for(;c<m;c++){var x=e[c],k=x instanceof Float32Array,M=(_=f,x.length),I=v&&v.Embed,L=0,A=0,R=0,O=0;if(y<1){for(var D=S+_,E=u,U=0;U<M;U++){var z=x[U];k&&(z=(z=Math.max(-1,Math.min(1,z)))<0?32768*z:32767*z);var N=Math.floor(D);D+=w;for(var F=Math.floor(D),P=(z-E)/(F-N),W=1;N<F;N++,W++){var B=Math.floor(E+W*P);I?(R=B,O=I.b0*R+I.b1*I.x1+I.b0*I.x2-I.a1*I.y1-I.a2*I.y2,I.x2=I.x1,I.x1=R,I.y2=I.y1,I.y1=O,B=O):B=v?v(B):B,B>32767?B=32767:B<-32768&&(B=-32768),g&&(d+=Math.abs(B)),b[N]=B,S++}E=u=z,_+=w}f=_%1}else{U=0;for(var $=0;U<M;U++,$++){if($<M){z=x[$];k&&(z=(z=Math.max(-1,Math.min(1,z)))<0?32768*z:32767*z),I?(R=z,O=I.b0*R+I.b1*I.x1+I.b0*I.x2-I.a1*I.y1-I.a2*I.y2,I.x2=I.x1,I.x1=R,I.y2=I.y1,I.y1=O):O=v?v(z):z}if(L=A,A=O,0!=$){var j=Math.floor(_);if(U==j){var V=L+((Math.ceil(_)<M?A:L)-L)*(_-j);V>32767?V=32767:V<-32768&&(V=-32768),g&&(d+=Math.abs(V)),b[S]=V,S++,_+=y}}else U--}f=Math.max(0,_-M)}}y<1&&S+1==C&&(C--,b=new Int16Array(b.buffer.slice(0,2*C))),S-1!=C&&S!=C&&T(s+" idx:"+S+" != size:"+C,3),p=null;var J=C%h;if(J>0){var H=2*(C-J);p=new Int16Array(b.buffer.slice(H)),b=new Int16Array(b.buffer.slice(0,H))}var K={index:c,offset:f,raisePrev:u,filter:l,frameNext:p,sampleRate:n,data:b};return g&&(K._sum=d),K},o.IIRFilter=function(e,t,n){var r=2*Math.PI*n/t,a=Math.sin(r),o=Math.cos(r),s=a/2,i=1+s,c=-2*o/i,f=(1-s)/i;if(e)var u=(1-o)/2/i,l=(1-o)/i;else u=(1+o)/2/i,l=-(1+o)/i;var v=0,p=0,h=0,g=0,d=0,m=function(e){return h=u*e+l*v+u*p-c*g-f*d,p=v,v=e,d=g,g=h,h};return m.Embed={x1:0,x2:0,y1:0,y2:0,b0:u,b1:l,a1:c,a2:f},m},o.PowerLevel=function(e,t){var n=e/t||0;return n<1251?Math.round(n/1250*10):Math.round(Math.min(100,Math.max(0,100*(1+Math.log(n/1e4)/Math.log(10)))))},o.PowerDBFS=function(e){var t=Math.max(.1,e||0),n=32767;return t=Math.min(t,n),t=20*Math.log(t/n)/Math.log(10),Math.max(-100,Math.round(t))},o.CLog=function(e,t){if("object"==typeof console){var n=new Date,a=("0"+n.getMinutes()).substr(-2)+":"+("0"+n.getSeconds()).substr(-2)+"."+("00"+n.getMilliseconds()).substr(-3),s=this&&this.envIn&&this.envCheck&&this.id,i=["["+a+" "+c+(s?":"+s:"")+"]"+e],f=arguments,u=o.CLog,l=2,v=u.log||console.log;for(r(t)?v=1==t?u.error||console.error:3==t?u.warn||console.warn:v:l=1;l<f.length;l++)i.push(f[l]);A?v&&v("[IsLoser]"+i[0],i.length>1?i:""):v.apply(console,i)}};var T=function(){o.CLog.apply(this,arguments)},A=!0;try{A=!console.log.apply}catch(W){}var R=0;function O(e){var t=this;t.id=++R,P();var a={type:"mp3",onProcess:n};for(var o in e)a[o]=e[o];t.set=a;var s=a[v],i=a[l];(s&&!r(s)||i&&!r(i))&&t.CLog(G.G("IllegalArgs-1",[G("VtS4::{1}\u548c{2}\u5fc5\u987b\u662f\u6570\u503c",0,l,v)]),1,e),a[v]=+s||16,a[l]=+i||16e3,t.state=0,t._S=9,t.Sync={O:9,C:9}}o.Sync={O:9,C:9},o.prototype=O.prototype={CLog:T,_streamStore:function(){return this.set.sourceStream?this:o},_streamGet:function(){return this._streamStore().Stream},_streamCtx:function(){var e=this._streamGet();return e&&e._c},open:function(e,r){var c=this,u=c.set,v=c._streamStore(),h=0;e=e||n;var g=function(e,t){t=!!t,c.CLog(G("5tWi::\u5f55\u97f3open\u5931\u8d25\uff1a")+e+",isUserNotAllow:"+t,1),h&&o.CloseNewCtx(h),r&&r(e,t)};c._streamTag=f;var d=function(){c.CLog("open ok, id:"+c.id+" stream:"+c._streamTag),e(),c._SO=0},m=v.Sync,C=++m.O,y=m.C;c._O=c._O_=C,c._SO=c._S;var w=function(){if(y!=m.C||!c._O){var e=G("dFm8::open\u88ab\u53d6\u6d88");return C==m.O?c.close():e=G("VtJO::open\u88ab\u4e2d\u65ad"),g(e),!0}};if(t){var S=c.envCheck({envName:"H5",canProcess:!0});if(S)g(G("A5bm::\u4e0d\u80fd\u5f55\u97f3\uff1a")+S);else{var x,k=function(){(x=u.runningContext)||(x=h=o.GetContext(!0))};if(u.sourceStream){if(c._streamTag="set.sourceStream",!o.GetContext())return void g(G("1iU7::\u4e0d\u652f\u6301\u6b64\u6d4f\u89c8\u5668\u4ece\u6d41\u4e2d\u83b7\u53d6\u5f55\u97f3"));k(),M(v);var I=c.Stream=u.sourceStream;I._c=x,I._RC=u.runningContext,I._call={};try{b(v)}catch(W){return M(v),void g(G("BTW2::\u4ece\u6d41\u4e2d\u6253\u5f00\u5f55\u97f3\u5931\u8d25\uff1a")+W.message)}d()}else{var L=function(e,t){try{window.top.a}catch(W){return void g(G("Nclz::\u65e0\u6743\u5f55\u97f3(\u8de8\u57df\uff0c\u8bf7\u5c1d\u8bd5\u7ed9iframe\u6dfb\u52a0\u9ea6\u514b\u98ce\u8bbf\u95ee\u7b56\u7565\uff0c\u5982{1})",0,'allow="camera;microphone"'))}T(1,e)&&(/Found/i.test(e)?g(t+G("jBa9::\uff0c\u65e0\u53ef\u7528\u9ea6\u514b\u98ce")):g(t))},T=function(e,t){if(/Permission|Allow/i.test(t))e&&g(G("gyO5::\u7528\u6237\u62d2\u7edd\u4e86\u5f55\u97f3\u6743\u9650"),!0);else{if(!1!==window.isSecureContext)return 1;e&&g(G("oWNo::\u6d4f\u89c8\u5668\u7981\u6b62\u4e0d\u5b89\u5168\u9875\u9762\u5f55\u97f3\uff0c\u53ef\u5f00\u542fhttps\u89e3\u51b3"))}};if(o.IsOpen())d();else if(o.Support()){k();var A,R,O=function(e){setTimeout((function(){e._call={};var t=o.Stream;t&&(M(),e._call=t._call),o.Stream=e,e._c=x,e._RC=u.runningContext,w()||(o.IsOpen()?(t&&c.CLog(G("upb8::\u53d1\u73b0\u540c\u65f6\u591a\u6b21\u8c03\u7528open"),1),b(v),d()):g(G("Q1GA::\u5f55\u97f3\u529f\u80fd\u65e0\u6548\uff1a\u65e0\u97f3\u9891\u6d41")))}),100)},D=function(e){var t=e.name||e.message||e.code+":"+e,n="";1==E&&T(0,t)&&(n=G("KxE2::\uff0c\u5c06\u5c1d\u8bd5\u7981\u7528\u56de\u58f0\u6d88\u9664\u540e\u91cd\u8bd5"));var r=G("xEQR::\u8bf7\u6c42\u5f55\u97f3\u6743\u9650\u9519\u8bef"),a=G("bDOG::\u65e0\u6cd5\u5f55\u97f3\uff1a");c.CLog(r+n+"|"+e,n||R?3:1,e),n?(A=t,R=e,U(1)):R?(c.CLog(r+"|"+R,1,R),L(A,a+R)):L(t,a+e)},E=0,U=function(e){E++;var t="audioTrackSet",n="autoGainControl",r="echoCancellation",v="noiseSuppression",h=t+":{"+r+","+v+","+n+"}",g=JSON.parse(a(u[t]||!0));c.CLog("open... "+E+" "+t+":"+a(g)),e&&("object"!=typeof g&&(g={}),g[n]=!1,g[r]=!1,g[v]=!1),g[l]&&c.CLog(G("IjL3::\u6ce8\u610f\uff1a\u5df2\u914d\u7f6e{1}\u53c2\u6570\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u6d4f\u89c8\u5668\u4e0d\u80fd\u6b63\u786e\u9009\u7528\u9ea6\u514b\u98ce\u3001\u79fb\u52a8\u7aef\u65e0\u6cd5\u542f\u7528\u56de\u58f0\u6d88\u9664\u7b49\u73b0\u8c61",0,t+"."+l),3);var d={audio:g,video:u.videoTrackSet||!1};try{var m=o.Scope[f](d,O,D)}catch(W){c.CLog(f,3,W),d={audio:!0,video:!1},m=o.Scope[f](d,O,D)}c.CLog(f+"("+a(d)+") "+_(x)+G("RiWe::\uff0c\u672a\u914d\u7f6e {1} \u65f6\u6d4f\u89c8\u5668\u53ef\u80fd\u4f1a\u81ea\u52a8\u542f\u7528\u56de\u58f0\u6d88\u9664\uff0c\u79fb\u52a8\u7aef\u672a\u7981\u7528\u56de\u58f0\u6d88\u9664\u65f6\u53ef\u80fd\u4f1a\u964d\u4f4e\u7cfb\u7edf\u64ad\u653e\u97f3\u91cf\uff08\u5173\u95ed\u5f55\u97f3\u540e\u53ef\u6062\u590d\uff09\u548c\u4ec5\u63d0\u4f9b16k\u91c7\u6837\u7387\u7684\u97f3\u9891\u6d41\uff08\u4e0d\u9700\u8981\u56de\u58f0\u6d88\u9664\u65f6\u53ef\u660e\u786e\u914d\u7f6e\u6210\u7981\u7528\u6765\u83b7\u5f9748k\u9ad8\u97f3\u8d28\u7684\u6d41\uff09\uff0c\u8bf7\u53c2\u9605\u6587\u6863\u4e2d{2}\u914d\u7f6e",0,h,t)+"("+i+") LM:"+s+" UA:"+navigator.userAgent),m&&m.then&&m.then(O)[p](D)};U()}else L("",G("COxc::\u6b64\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5f55\u97f3"))}}}else g(G.G("NonBrowser-1",["open"])+G("EMJq::\uff0c\u53ef\u5c1d\u8bd5\u4f7f\u7528RecordApp\u89e3\u51b3\u65b9\u6848")+"("+i+"/tree/master/app-support-sample)")},close:function(e){e=e||n;var t=this,r=t._streamStore();t._stop();var a=" stream:"+t._streamTag,o=r.Sync;if(t._O=0,t._O_!=o.O)return t.CLog(G("hWVz::close\u88ab\u5ffd\u7565\uff08\u56e0\u4e3a\u540c\u65f6open\u4e86\u591a\u4e2arec\uff0c\u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u771f\u6b63close\uff09")+a,3),void e();o.C++,M(r),t.CLog("close,"+a),e()},mock:function(e,t){var n=this;return n._stop(),n.isMock=1,n.mockEnvInfo=null,n.buffers=[e],n.recSize=e.length,n._setSrcSR(t),n._streamTag="mock",n},_setSrcSR:function(e){var t=this,n=t.set,r=n[l];r>e?n[l]=e:r=0,t[u]=e,t.CLog(u+": "+e+" set."+l+": "+n[l]+(r?" "+G("UHvm::\u5ffd\u7565")+": "+r:""),r?3:0)},envCheck:function(e){var t,n=this,r=n.set,a="CPU_BE";if(t||o[a]||"function"!=typeof Int8Array||new Int8Array(new Int32Array([1]).buffer)[0]||(P(a),t=G("Essp::\u4e0d\u652f\u6301{1}\u67b6\u6784",0,a)),!t){var s=r.type,i=n[s+"_envCheck"];r.takeoffEncodeChunk&&(i?e.canProcess||(t=G("7uMV::{1}\u73af\u5883\u4e0d\u652f\u6301\u5b9e\u65f6\u5904\u7406",0,e.envName)):t=G("2XBl::{1}\u7c7b\u578b\u4e0d\u652f\u6301\u8bbe\u7f6etakeoffEncodeChunk",0,s)+(n[s]?"":G("LG7e::(\u672a\u52a0\u8f7d\u7f16\u7801\u5668)"))),!t&&i&&(t=n[s+"_envCheck"](e,r))}return t||""},envStart:function(e,t){var n=this,r=n.set;if(n.isMock=e?1:0,n.mockEnvInfo=e,n.buffers=[],n.recSize=0,e&&(n._streamTag="env$"+e.envName),n.state=1,n.envInLast=0,n.envInFirst=0,n.envInFix=0,n.envInFixTs=[],n._setSrcSR(t),n.engineCtx=0,n[r.type+"_start"]){var a=n.engineCtx=n[r.type+"_start"](r);a&&(a.pcmDatas=[],a.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(e,t){var n=this,r=n.set,a=n.engineCtx;if(1==n.state){var s=n[u],i=e.length,c=o.PowerLevel(t,i),f=n.buffers,v=f.length;f.push(e);var p=f,h=v,g=Date.now(),d=Math.round(i/s*1e3);n.envInLast=g,1==n.buffers.length&&(n.envInFirst=g-d);var m=n.envInFixTs;m.splice(0,0,{t:g,d:d});for(var C=g,_=0,y=0;y<m.length;y++){var w=m[y];if(g-w.t>3e3){m.length=y;break}C=w.t,_+=w.d}var b=m[1],S=g-C;if(S-_>S/3&&(b&&S>1e3||m.length>=6)){var x=g-b.t-d;if(x>d/5){var k=!r.disableEnvInFix;if(n.CLog("["+g+"]"+F.get(G(k?"4Kfd::\u8865\u507f{1}ms":"bM5i::\u672a\u8865\u507f{1}ms",1),[x]),3),n.envInFix+=x,k){var M=new Int16Array(x*s/1e3);i+=M.length,f.push(M)}}}var I=n.recSize,L=i,T=I+L;if(n.recSize=T,a){var A=o.SampleData(f,s,r[l],a.chunkInfo);a.chunkInfo=A,T=(I=a.pcmSize)+(L=A.data.length),a.pcmSize=T,f=a.pcmDatas,v=f.length,f.push(A.data),s=A[l]}var R=Math.round(T/s*1e3),O=f.length,D=p.length,E=function(){for(var e=U?0:-L,t=null==f[0],o=v;o<O;o++){var s=f[o];null==s?t=1:(e+=s.length,a&&s.length&&n[r.type+"_encode"](a,s))}if(t&&a){o=h;for(p[0]&&(o=0);o<D;o++)p[o]=null}t&&(e=U?L:0,f[0]=null),a?a.pcmSize+=e:n.recSize+=e},U=0,z="rec.set.onProcess";try{U=!0===(U=r.onProcess(f,c,R,s,v,E))}catch(W){console.error(z+G("gFUF::\u56de\u8c03\u51fa\u9519\u662f\u4e0d\u5141\u8bb8\u7684\uff0c\u9700\u4fdd\u8bc1\u4e0d\u4f1a\u629b\u5f02\u5e38"),W)}var N=Date.now()-g;if(N>10&&n.envInFirst-g>1e3&&n.CLog(z+G("2ghS::\u4f4e\u6027\u80fd\uff0c\u8017\u65f6{1}ms",0,N),3),U){var P=0;for(y=v;y<O;y++)null==f[y]?P=1:f[y]=new Int16Array(0);P?n.CLog(G("ufqH::\u672a\u8fdb\u5165\u5f02\u6b65\u524d\u4e0d\u80fd\u6e05\u9664buffers"),3):a?a.pcmSize-=L:n.recSize-=L}else E()}else n.state||n.CLog("envIn at state=0",3)},start:function(){var e=this,t=1;if(e.set.sourceStream?e.Stream||(t=0):o.IsOpen()||(t=0),t){var n=e._streamCtx();if(e.CLog(G("kLDN::start \u5f00\u59cb\u5f55\u97f3\uff0c")+_(n)+" stream:"+e._streamTag),e._stop(),e.envStart(null,n[l]),e.state=3,e._SO&&e._SO+1!=e._S)e.CLog(G("Bp2y::start\u88ab\u4e2d\u65ad"),3);else{e._SO=0;var r=function(){3==e.state&&(e.state=1,e.resume())},a="AudioContext resume: ";e._streamGet()._call[e.id]=function(){e.CLog(a+n.state+"|stream ok"),r()},m(n,(function(t){return t&&e.CLog(a+"wait..."),3==e.state}),(function(t){t&&e.CLog(a+n.state),r()}),(function(t){e.CLog(a+n.state+G("upkE::\uff0c\u53ef\u80fd\u65e0\u6cd5\u5f55\u97f3\uff1a")+t,1),r()}))}}else e.CLog(G("6WmN::start\u5931\u8d25\uff1a\u672aopen"),1)},pause:function(){var e=this,t=e._streamGet();e.state&&(e.state=2,e.CLog("pause"),t&&delete t._call[e.id])},resume:function(){var e=this,t=e._streamGet(),n="resume",r=n+"(wait ctx)";if(3==e.state)e.CLog(r);else if(e.state){e.state=1,e.CLog(n),e.envResume(),t&&(t._call[e.id]=function(t,n){1==e.state&&e.envIn(t,n)},S(t));var a=e._streamCtx();a&&m(a,(function(t){return t&&e.CLog(r+"..."),1==e.state}),(function(n){n&&e.CLog(r+a.state),S(t)}),(function(t){e.CLog(r+a.state+"[err]"+t,1)}))}},_stop:function(e){var t=this,n=t.set;t.isMock||t._S++,t.state&&(t.pause(),t.state=0),!e&&t[n.type+"_stop"]&&(t[n.type+"_stop"](t.engineCtx),t.engineCtx=0)},stop:function(e,t,n){var r,a=this,f=a.set,v=a.envInLast-a.envInFirst,p=v&&a.buffers.length;a.CLog(G("Xq4s::stop \u548cstart\u65f6\u5dee:")+(v?v+"ms "+G("3CQP::\u8865\u507f:")+a.envInFix+"ms envIn:"+p+" fps:"+(p/v*1e3).toFixed(1):"-")+" stream:"+a._streamTag+" ("+i+") LM:"+s);var h=function(){a._stop(),n&&a.close()},g=function(e){a.CLog(G("u8JG::\u7ed3\u675f\u5f55\u97f3\u5931\u8d25\uff1a")+e,1),t&&t(e),h()},d=function(t,n,s){var i="blob",u="arraybuffer",l="dataType",v="DefaultDataType",p=a[l]||o[v]||i,d=l+"="+p,m=t instanceof ArrayBuffer,C=0,_=m?t.byteLength:t.size;if(p==u?m||(C=1):p==i?"function"!=typeof Blob?C=G.G("NonBrowser-1",[d])+G("1skY::\uff0c\u8bf7\u8bbe\u7f6e{1}",0,c+"."+v+'="'+u+'"'):(m&&(t=new Blob([t],{type:n})),t instanceof Blob||(C=1),n=t.type||n):C=G.G("NotSupport-1",[d]),a.CLog(G("Wv7l::\u7ed3\u675f\u5f55\u97f3 \u7f16\u7801\u82b1{1}ms \u97f3\u9891\u65f6\u957f{2}ms \u6587\u4ef6\u5927\u5c0f{3}b",0,Date.now()-r,s,_)+" "+d+","+n),C)g(1!=C?C:G("Vkbd::{1}\u7f16\u7801\u5668\u8fd4\u56de\u7684\u4e0d\u662f{2}",0,f.type,p)+", "+d);else{if(f.takeoffEncodeChunk)a.CLog(G("QWnr::\u542f\u7528takeoffEncodeChunk\u540estop\u8fd4\u56de\u7684blob\u957f\u5ea6\u4e3a0\u4e0d\u63d0\u4f9b\u97f3\u9891\u6570\u636e"),3);else if(_<Math.max(50,s/5))return void g(G("Sz2H::\u751f\u6210\u7684{1}\u65e0\u6548",0,f.type));e&&e(t,s,n),h()}};if(!a.isMock){var m=3==a.state;if(!a.state||m)return void g(G("wf9t::\u672a\u5f00\u59cb\u5f55\u97f3")+(m?G("Dl2c::\uff0c\u5f00\u59cb\u5f55\u97f3\u524d\u65e0\u7528\u6237\u4ea4\u4e92\u5bfc\u81f4AudioContext\u672a\u8fd0\u884c"):""))}a._stop(!0);var C=a.recSize;if(C)if(a[f.type]){if(a.isMock){var _=a.envCheck(a.mockEnvInfo||{envName:"mock",canProcess:!1});if(_)return void g(G("AxOH::\u5f55\u97f3\u9519\u8bef\uff1a")+_)}var y=a.engineCtx;if(a[f.type+"_complete"]&&y){var w=Math.round(y.pcmSize/f[l]*1e3);return r=Date.now(),void a[f.type+"_complete"](y,(function(e,t){d(e,t,w)}),g)}if(r=Date.now(),a.buffers[0]){var b=o.SampleData(a.buffers,a[u],f[l]);f[l]=b[l];var S=b.data;w=Math.round(S.length/f[l]*1e3);a.CLog(G("CxeT::\u91c7\u6837:{1} \u82b1:{2}ms",0,C+"->"+S.length,Date.now()-r)),setTimeout((function(){r=Date.now(),a[f.type](S,(function(e,t){d(e,t,w)}),(function(e){g(e)}))}))}else g(G("xkKd::\u97f3\u9891buffers\u88ab\u91ca\u653e"))}else g(G("xGuI::\u672a\u52a0\u8f7d{1}\u7f16\u7801\u5668\uff0c\u8bf7\u5c1d\u8bd5\u5230{2}\u7684src/engine\u5185\u627e\u5230{1}\u7684\u7f16\u7801\u5668\u5e76\u52a0\u8f7d",0,f.type,c));else g(G("Ltz3::\u672a\u91c7\u96c6\u5230\u5f55\u97f3"))}};var D=function(e,t){t.pos||(t.pos=[0],t.tracks={},t.bytes=[]);var n=t.tracks,r=[t.pos[0]],a=function(){t.pos[0]=r[0]},o=t.bytes.length,s=new Uint8Array(o+e.length);if(s.set(t.bytes),s.set(e,o),t.bytes=s,!t._ht){if(z(s,r),N(s,r),!E(z(s,r),[24,83,128,103]))return;for(z(s,r);r[0]<s.length;){var i=z(s,r),c=N(s,r),f=[0],u=0;if(!c)return;if(E(i,[22,84,174,107])){for(;f[0]<c.length;){var v=z(c,f),p=N(c,f),h=[0],g={channels:0,sampleRate:0};if(E(v,[174]))for(;h[0]<p.length;){var d=z(p,h),m=N(p,h),C=[0];if(E(d,[215])){var _=U(m);g.number=_,n[_]=g}else if(E(d,[131])){1==(_=U(m))?g.type="video":2==_?(g.type="audio",u||(t.track0=g),g.idx=u++):g.type="Type-"+_}else if(E(d,[134])){for(var y="",w=0;w<m.length;w++)y+=String.fromCharCode(m[w]);g.codec=y}else if(E(d,[225]))for(;C[0]<m.length;){var b=z(m,C),S=N(m,C);if(E(b,[181])){_=0;var x=new Uint8Array(S.reverse()).buffer;4==S.length?_=new Float32Array(x)[0]:8==S.length?_=new Float64Array(x)[0]:T("WebM Track !Float",1,S),g[l]=Math.round(_)}else E(b,[98,100])?g.bitDepth=U(S):E(b,[159])&&(g.channels=U(S))}}}t._ht=1,T("WebM Tracks",n),a();break}}}var k=t.track0;if(k){var M=k[l];if(t.webmSR=M,16==k.bitDepth&&/FLOAT/i.test(k.codec)&&(k.bitDepth=32,T("WebM 16->32 bit",3)),M<8e3||32!=k.bitDepth||k.channels<1||!/(\b|_)PCM\b/i.test(k.codec))return t.bytes=[],t.bad||T("WebM Track Unexpected",3,t),t.bad=1,-1;for(var I=[],L=0;r[0]<s.length;){v=z(s,r);if(!(p=N(s,r)))break;if(E(v,[163])){var A=15&p[0];if(!(g=n[A]))return T("WebM !Track"+A,1,n),-1;if(0===g.idx){var R=new Uint8Array(p.length-4);for(w=4;w<p.length;w++)R[w-4]=p[w];I.push(R),L+=R.length}}a()}if(L){var O=new Uint8Array(s.length-t.pos[0]);O.set(s.subarray(t.pos[0])),t.bytes=O,t.pos[0]=0;R=new Uint8Array(L),w=0;for(var D=0;w<I.length;w++)R.set(I[w],D),D+=I[w].length;x=new Float32Array(R.buffer);if(k.channels>1){var F=[];for(w=0;w<x.length;)F.push(x[w]),w+=k.channels;x=new Float32Array(F)}return x}}},E=function(e,t){if(!e||e.length!=t.length)return!1;if(1==e.length)return e[0]==t[0];for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0},U=function(e){for(var t="",n=0;n<e.length;n++){var r=e[n];t+=(r<16?"0":"")+r.toString(16)}return parseInt(t,16)||0},z=function(e,t,n){var r=t[0];if(!(r>=e.length)){var a=("0000000"+e[r].toString(2)).substr(-8),o=/^(0*1)(\d*)$/.exec(a);if(o){var s=o[1].length,i=[];if(!(r+s>e.length)){for(var c=0;c<s;c++)i[c]=e[r],r++;return n&&(i[0]=parseInt(o[2]||"0",2)),t[0]=r,i}}}},N=function(e,t){var n=z(e,t,1);if(n){var r=U(n),a=t[0],o=[];if(r<2147483647){if(a+r>e.length)return;for(var s=0;s<r;s++)o[s]=e[a],a++}return t[0]=a,o}},F=o.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(e,t){var n=c+".i18n.put: ",r=e.overwrite;r=null==r||r;var a=e.lang;if(!(a=F.alias[a]||a))throw new Error(n+"set.lang?");var o=F.locales[a];o||(o={},F.locales[a]=o);for(var s,i=/^([\w\-]+):/,f=0;f<t.length;f++){var u=t[f];if(s=i.exec(u)){var l=s[1];u=u.substr(l.length+1);!r&&o[l]||(o[l]=u)}else T(n+"'key:'? "+u,3,e)}},get:function(){return F.v_G.apply(null,arguments)},v_G:function(e,t,n){t=t||[],n=n||F.lang,n=F.alias[n]||n;var r=F.locales[n],a=r&&r[e]||"";return a||"zh"==n?(F.lastLang=n,"=Empty"==a?"":a.replace(/\{(\d+)(\!?)\}/g,(function(n,r,o){return n=t[(r=+r||0)-1],(r<1||r>t.length)&&(n="{?}",T("i18n["+e+"] no {"+r+"}: "+a,3)),o?"":n}))):"en"==n?F.v_G(e,t,"zh"):F.v_G(e,t,"en")},$T:function(){return F.v_T.apply(null,arguments)},v_T:function(){for(var e,t=arguments,n="",a=[],o=0,s=c+".i18n.$T:",i=/^([\w\-]*):/,f=0;f<t.length;f++){var u=t[f];if(0==f){if(!(n=(e=i.exec(u))&&e[1]))throw new Error(s+"0 'key:'?");u=u.substr(n.length+1)}if(-1===o)a.push(u);else{if(o)throw new Error(s+" bad args");if(0===u)o=-1;else if(r(u)){if(u<1)throw new Error(s+" bad args");o=u}else{var l=1==f?"en":f?"":"zh";if((e=i.exec(u))&&(l=e[1]||l,u=u.substr(e[1].length+1)),!e||!l)throw new Error(s+f+" 'lang:'?");F.put({lang:l,overwrite:!1},[n+":"+u])}}}return n?o>0?n:F.v_G(n,a):""}},G=F.$T;G.G=F.get,G("NonBrowser-1::\u975e\u6d4f\u89c8\u5668\u73af\u5883\uff0c\u4e0d\u652f\u6301{1}",1),G("IllegalArgs-1::\u53c2\u6570\u9519\u8bef\uff1a{1}",1),G("NeedImport-2::\u8c03\u7528{1}\u9700\u8981\u5148\u5bfc\u5165{2}",2),G("NotSupport-1::\u4e0d\u652f\u6301\uff1a{1}",1),o.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var P=o.Traffic=function(e){if(t){e=e?"/"+c+"/Report/"+e:"";var n=o.TrafficImgUrl;if(n){var r=o.Traffic,a=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],s=a[1]||"http://file/",i=(a[0]||s)+e;if(0==n.indexOf("//")&&(n=/^https:/i.test(i)?"https:"+n:"http:"+n),e&&(n=n+"&cu="+encodeURIComponent(s+e)),!r[i])r[i]=1,(new Image).src=n,T("Traffic Analysis Image: "+(e||c+".TrafficImgUrl="+o.TrafficImgUrl))}}};h&&(T(G("8HO5::\u8986\u76d6\u5bfc\u5165{1}",0,c),1),h.Destroy());e[c]=o}(o,a),void 0===(r=function(){return o.Recorder}.call(t,n,t,e))||(e.exports=r),e.exports&&(e.exports=o.Recorder)}()},48996:(e,t,n)=>{var r;!function(){var a="object"==typeof window&&!!window.document,o=a?window:Object;!function(e,t){"use strict";var n=function(){},r=function(e){return"number"==typeof e},a=function(e){return JSON.stringify(e)},o=function(e){return new O(e)},s=o.LM="2025-01-11 09:28",i="https://github.com/xiangyuecn/Recorder",c="Recorder",f="getUserMedia",u="srcSampleRate",l="sampleRate",v="bitRate",p="catch",h=e[c];if(h&&h.LM==s)return h.CLog(h.i18n.$T("K8zP::\u91cd\u590d\u5bfc\u5165{1}",0,c),3);o.IsOpen=function(){var e=o.Stream;if(e){var t=L(e)[0];if(t){var n=t.readyState;return"live"==n||n==t.LIVE}}return!1},o.BufferSize=4096,o.Destroy=function(){for(var e in T(c+" Destroy"),M(),g)g[e]()};var g={};o.BindDestroy=function(e,t){g[e]=t},o.Support=function(){if(!t)return!1;var e=navigator.mediaDevices||{};return e[f]||(e=navigator)[f]||(e[f]=e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia),!!e[f]&&(o.Scope=e,!!o.GetContext())},o.GetContext=function(e){if(!t)return null;var n=window.AudioContext;if(n||(n=window.webkitAudioContext),!n)return null;var r=o.Ctx,a=0;return r||(r=o.Ctx=new n,a=1,o.NewCtxs=o.NewCtxs||[],o.BindDestroy("Ctx",(function(){var e=o.Ctx;e&&e.close&&(d(e),o.Ctx=0);var t=o.NewCtxs;o.NewCtxs=[];for(var n=0;n<t.length;n++)d(t[n])}))),e&&r.close&&(a||(r._useC||d(r),r=new n),r._useC=1,o.NewCtxs.push(r)),r},o.CloseNewCtx=function(e){if(e&&e.close){d(e);for(var t=o.NewCtxs||[],n=t.length,r=0;r<t.length;r++)if(t[r]==e){t.splice(r,1);break}T(G("mSxV::\u5269{1}\u4e2aGetContext\u672aclose",0,n+"-1="+t.length),t.length?3:0)}};var d=function(e){if(e&&e.close&&!e._isC&&(e._isC=1,"closed"!=e.state))try{e.close()}catch(e){T("ctx close err",1,e)}},m=o.ResumeCtx=function(e,t,n,r){var a=0,o=0,s=0,i=0,c="EventListener",f="ResumeCtx ",u=function(t,f){o&&l(),a||(a=1,t&&r(t,i),f&&n(i)),f&&(!e._LsSC&&e["add"+c]&&e["add"+c]("statechange",v),e._LsSC=1,s=1)},l=function(e){if(!e||!o){o=e?1:0;for(var t=["focus","mousedown","mouseup","touchstart","touchend"],n=0;n<t.length;n++)window[(e?"add":"remove")+c](t[n],v,!0)}},v=function(){var n=e.state,r=C(n);if(!a&&!t(r?++i:i))return u();r?(s&&T(f+"sc "+n,3),l(1),e.resume().then((function(){s&&T(f+"sc "+e.state),u(0,1)}))[p]((function(t){T(f+"error",1,t),C(e.state)||u(t.message||"error")}))):"closed"==n?(s&&!e._isC&&T(f+"sc "+n,1),u("ctx closed")):u(0,1)};v()},C=o.CtxSpEnd=function(e){return"suspended"==e||"interrupted"==e},_=function(e){var t=e.state,n="ctx.state="+t;return C(t)&&(n+=G("nMIy::\uff08\u6ce8\u610f\uff1actx\u4e0d\u662frunning\u72b6\u6001\uff0crec.open\u548cstart\u81f3\u5c11\u8981\u6709\u4e00\u4e2a\u5728\u7528\u6237\u64cd\u4f5c(\u89e6\u6478\u3001\u70b9\u51fb\u7b49)\u65f6\u8fdb\u884c\u8c03\u7528\uff0c\u5426\u5219\u5c06\u5728rec.start\u65f6\u5c1d\u8bd5\u8fdb\u884cctx.resume\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u517c\u5bb9\u6027\u95ee\u9898(\u4ec5iOS)\uff0c\u8bf7\u53c2\u9605\u6587\u6863\u4e2drunningContext\u914d\u7f6e\uff09")),n},y="ConnectEnableWebM";o[y]=!0;var w="ConnectEnableWorklet";o[w]=!1;var b=function(e){var t=e.BufferSize||o.BufferSize,n=e.Stream,r=n._c,s=r[l],i={},f=L(n)[0],u=null,v="";if(f&&f.getSettings){var h=(u=f.getSettings())[l];h&&h!=s&&(v=G("eS8i::Stream\u7684\u91c7\u6837\u7387{1}\u4e0d\u7b49\u4e8e{2}\uff0c\u5c06\u8fdb\u884c\u91c7\u6837\u7387\u8f6c\u6362\uff08\u6ce8\u610f\uff1a\u97f3\u8d28\u4e0d\u4f1a\u53d8\u597d\u751a\u81f3\u53ef\u80fd\u53d8\u5dee\uff09\uff0c\u4e3b\u8981\u5728\u79fb\u52a8\u7aef\u672a\u7981\u7528\u56de\u58f0\u6d88\u9664\u65f6\u4f1a\u4ea7\u751f\u6b64\u73b0\u8c61\uff0c\u6d4f\u89c8\u5668\u6709\u56de\u58f0\u6d88\u9664\u65f6\u53ef\u80fd\u53ea\u4f1a\u8fd4\u56de16k\u91c7\u6837\u7387\u7684\u97f3\u9891\u6570\u636e\uff0c",0,h,s))}n._ts=u,T(v+"Stream TrackSet: "+a(u),v?3:0);var g,d,C,_=function(e){var t=n._m=r.createMediaStreamSource(n),a=r.destination,o="createMediaStreamDestination";r[o]&&(a=n._d=r[o]()),t.connect(e),e.connect(a)},b="",S=n._call,M=function(e,t){for(var n in S){if(t!=s){i.index=0;var r=(i=o.SampleData([e],t,s,i,{_sum:1})).data,a=i._sum}else{i={};for(var c=e.length,f=(r=new Int16Array(c),a=0,0);f<c;f++){var u=Math.max(-1,Math.min(1,e[f]));u=u<0?32768*u:32767*u,r[f]=u,a+=Math.abs(u)}}for(var l in S)S[l](r,a);return}},I="ScriptProcessor",A="audioWorklet",R=c+" "+A,O="RecProc",E="MediaRecorder",U=E+".WebM.PCM",z=r.createScriptProcessor||r.createJavaScriptNode,N=G("ZGlf::\u3002\u7531\u4e8e{1}\u5185\u90e81\u79d2375\u6b21\u56de\u8c03\uff0c\u5728\u79fb\u52a8\u7aef\u53ef\u80fd\u4f1a\u6709\u6027\u80fd\u95ee\u9898\u5bfc\u81f4\u56de\u8c03\u4e22\u5931\u5f55\u97f3\u53d8\u77ed\uff0cPC\u7aef\u65e0\u5f71\u54cd\uff0c\u6682\u4e0d\u5efa\u8bae\u5f00\u542f{1}\u3002",0,A),P=function(){d=n.isWorklet=!1,x(n),T(G("7TU0::Connect\u91c7\u7528\u8001\u7684{1}\uff0c",0,I)+F.get(G(o[w]?"JwCL::\u4f46\u5df2\u8bbe\u7f6e{1}\u5c1d\u8bd5\u542f\u7528{2}":"VGjB::\u53ef\u8bbe\u7f6e{1}\u5c1d\u8bd5\u542f\u7528{2}",2),[c+"."+w+"=true",A])+b+N,3);var e=n._p=z.call(r,t,1,1);_(e),e.onaudioprocess=function(e){var t=e.inputBuffer.getChannelData(0);M(t,s)}},W=function(){g=n.isWebM=!1,k(n),d=n.isWorklet=!z||o[w];var e=window.AudioWorkletNode;if(d&&r[A]&&e){var a=function(){return d&&n._na},i=n._na=function(){""!==C&&(clearTimeout(C),C=setTimeout((function(){C=0,a()&&(T(G("MxX1::{1}\u672a\u8fd4\u56de\u4efb\u4f55\u97f3\u9891\uff0c\u6062\u590d\u4f7f\u7528{2}",0,A,I),3),z&&P())}),500))},f=function(){if(a()){var o=n._n=new e(r,O,{processorOptions:{bufferSize:t}});_(o),o.port.onmessage=function(e){C&&(clearTimeout(C),C=""),a()?M(e.data.val,s):d||T(G("XUap::{1}\u591a\u4f59\u56de\u8c03",0,A),3)},T(G("yOta::Connect\u91c7\u7528{1}\uff0c\u8bbe\u7f6e{2}\u53ef\u6062\u590d\u8001\u5f0f{3}",0,A,c+"."+w+"=false",I)+b+N,3)}},u=function(){if(a())if(r[O])f();else{var e,t,n=(t="class "+O+" extends AudioWorkletProcessor{",t+="constructor "+(e=function(e){return e.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,R)})((function(e){DEL_super(e);var t=this,n=e.processorOptions.bufferSize;t.bufferSize=n,t.buffer=new Float32Array(2*n),t.pos=0,t.port.onmessage=function(e){e.data.kill&&(t.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",e)})),t+="process "+e((function(e,t,n){var r=this,a=r.bufferSize,o=r.buffer,s=r.pos;if((e=(e[0]||[])[0]||[]).length){o.set(e,s);var i=~~((s+=e.length)/a)*a;if(i){this.port.postMessage({val:o.slice(0,i)});var c=o.subarray(i,s);(o=new Float32Array(2*a)).set(c),s=c.length,r.buffer=o}r.pos=s}return!r.kill})),t=(t+='}try{registerProcessor("'+O+'", '+O+')}catch(e){$C.error("'+R+' Reg Error",e)}').replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(t))));r[A].addModule(n).then((function(e){a()&&(r[O]=1,f(),C&&i())}))[p]((function(e){T(A+".addModule Error",1,e),a()&&P()}))}};m(r,(function(){return a()}),u,u)}else P()};!function(){var e=window[E],r="ondataavailable",a="audio/webm; codecs=pcm";g=n.isWebM=o[y];var s=e&&r in e.prototype&&e.isTypeSupported(a);if(b=s?"":G("VwPd::\uff08\u6b64\u6d4f\u89c8\u5668\u4e0d\u652f\u6301{1}\uff09",0,U),!g||!s)return W();var i=function(){return g&&n._ra};n._ra=function(){""!==C&&(clearTimeout(C),C=setTimeout((function(){i()&&(T(G("vHnb::{1}\u672a\u8fd4\u56de\u4efb\u4f55\u97f3\u9891\uff0c\u964d\u7ea7\u4f7f\u7528{2}",0,E,A),3),W())}),500))};var f=Object.assign({mimeType:a},o.ConnectWebMOptions),u=n._r=new e(n,f),l=n._rd={};u[r]=function(e){var t=new FileReader;t.onloadend=function(){if(i()){var e=D(new Uint8Array(t.result),l);if(!e)return;if(-1==e)return void W();C&&(clearTimeout(C),C=""),M(e,l.webmSR)}else g||T(G("O9P7::{1}\u591a\u4f59\u56de\u8c03",0,E),3)},t.readAsArrayBuffer(e.data)};try{u.start(~~(t/48)),T(G("LMEm::Connect\u91c7\u7528{1}\uff0c\u8bbe\u7f6e{2}\u53ef\u6062\u590d\u4f7f\u7528{3}\u6216\u8001\u5f0f{4}",0,U,c+"."+y+"=false",A,I))}catch(e){T("mr start err",1,e),W()}}()},S=function(e){e._na&&e._na(),e._ra&&e._ra()},x=function(e){e._na=null,e._n&&(e._n.port.postMessage({kill:!0}),e._n.disconnect(),e._n=null)},k=function(e){if(e._ra=null,e._r){try{e._r.stop()}catch(e){T("mr stop err",1,e)}e._r=null}},M=function(e){var t=(e=e||o)==o,n=e.Stream;n&&(n._m&&(n._m.disconnect(),n._m=null),!n._RC&&n._c&&o.CloseNewCtx(n._c),n._RC=null,n._c=null,n._d&&(I(n._d.stream),n._d=null),n._p&&(n._p.disconnect(),n._p.onaudioprocess=n._p=null),x(n),k(n),t&&I(n)),e.Stream=0},I=o.StopS_=function(e){for(var t=L(e),n=0;n<t.length;n++){var r=t[n];r.stop&&r.stop()}e.stop&&e.stop()},L=function(e){var t=0,n=0,r=[];e.getAudioTracks&&(t=e.getAudioTracks(),n=e.getVideoTracks()),t||(t=e.audioTracks,n=e.videoTracks);for(var a=0,o=t?t.length:0;a<o;a++)r.push(t[a]);for(a=0,o=n?n.length:0;a<o;a++)r.push(n[a]);return r};o.SampleData=function(e,t,n,r,a){var s="SampleData";r||(r={});var i=r.index||0,c=r.offset||0,f=r.raisePrev||0,u=r.filter;if(u&&u.fn&&(u.sr&&u.sr!=t||u.srn&&u.srn!=n)&&(u=null,T(G("d48C::{1}\u7684filter\u91c7\u6837\u7387\u53d8\u4e86\uff0c\u91cd\u8bbe\u6ee4\u6ce2",0,s),3)),!u)if(n<=t){u={fn:(l=3*t/4<n?0:n/2*3/4)?o.IIRFilter(!0,t,l):0}}else{var l;u={fn:(l=3*n/4<t?0:t/2*3/4)?o.IIRFilter(!0,n,l):0}}u.sr=t,u.srn=n;var v=u.fn,p=r.frameNext||[];a||(a={});var h=a.frameSize||1;a.frameType&&(h="mp3"==a.frameType?1152:1);var g=a._sum,d=0,m=e.length;m+1<i&&T(G("tlbC::{1}\u4f3c\u4e4e\u4f20\u5165\u4e86\u672a\u91cd\u7f6echunk {2}",0,s,i+">"+m),3);for(var C=0,_=i;_<m;_++)C+=e[_].length;var y=t/n;if(1<y)C=Math.max(0,C-Math.floor(c)),C=Math.floor(C/y);else if(y<1){var w=1/y;C=Math.floor(C*w)}C+=p.length;var b=new Int16Array(C),S=0;for(_=0;_<p.length;_++)b[S]=p[_],S++;for(;i<m;i++){var x=e[i],k=x instanceof Float32Array,M=(_=c,x.length),I=v&&v.Embed,L=0,A=0,R=0,O=0;if(y<1){for(var D=S+_,E=f,U=0;U<M;U++){var z=x[U];k&&(z=(z=Math.max(-1,Math.min(1,z)))<0?32768*z:32767*z);var N=Math.floor(D);D+=w;for(var F=Math.floor(D),P=(z-E)/(F-N),W=1;N<F;N++,W++){var B=Math.floor(E+W*P);I?(R=B,O=I.b0*R+I.b1*I.x1+I.b0*I.x2-I.a1*I.y1-I.a2*I.y2,I.x2=I.x1,I.x1=R,I.y2=I.y1,I.y1=O,B=O):B=v?v(B):B,32767<B?B=32767:B<-32768&&(B=-32768),g&&(d+=Math.abs(B)),b[N]=B,S++}E=f=z,_+=w}c=_%1}else{U=0;for(var $=0;U<M;U++,$++){if($<M){z=x[$];k&&(z=(z=Math.max(-1,Math.min(1,z)))<0?32768*z:32767*z),I?(R=z,O=I.b0*R+I.b1*I.x1+I.b0*I.x2-I.a1*I.y1-I.a2*I.y2,I.x2=I.x1,I.x1=R,I.y2=I.y1,I.y1=O):O=v?v(z):z}if(L=A,A=O,0!=$){var j=Math.floor(_);if(U==j){var V=L+((Math.ceil(_)<M?A:L)-L)*(_-j);32767<V?V=32767:V<-32768&&(V=-32768),g&&(d+=Math.abs(V)),b[S]=V,S++,_+=y}}else U--}c=Math.max(0,_-M)}}y<1&&S+1==C&&(C--,b=new Int16Array(b.buffer.slice(0,2*C))),S-1!=C&&S!=C&&T(s+" idx:"+S+" != size:"+C,3),p=null;var J=C%h;if(0<J){var H=2*(C-J);p=new Int16Array(b.buffer.slice(H)),b=new Int16Array(b.buffer.slice(0,H))}var K={index:i,offset:c,raisePrev:f,filter:u,frameNext:p,sampleRate:n,data:b};return g&&(K._sum=d),K},o.IIRFilter=function(e,t,n){var r=2*Math.PI*n/t,a=Math.sin(r),o=Math.cos(r),s=a/2,i=1+s,c=-2*o/i,f=(1-s)/i;if(e)var u=(1-o)/2/i,l=(1-o)/i;else u=(1+o)/2/i,l=-(1+o)/i;var v=0,p=0,h=0,g=0,d=0,m=function(e){return h=u*e+l*v+u*p-c*g-f*d,p=v,v=e,d=g,g=h};return m.Embed={x1:0,x2:0,y1:0,y2:0,b0:u,b1:l,a1:c,a2:f},m},o.PowerLevel=function(e,t){var n=e/t||0;return n<1251?Math.round(n/1250*10):Math.round(Math.min(100,Math.max(0,100*(1+Math.log(n/1e4)/Math.log(10)))))},o.PowerDBFS=function(e){var t=Math.max(.1,e||0);return t=Math.min(t,32767),t=20*Math.log(t/32767)/Math.log(10),Math.max(-100,Math.round(t))},o.CLog=function(e,t){if("object"==typeof console){var n=new Date,a=("0"+n.getMinutes()).substr(-2)+":"+("0"+n.getSeconds()).substr(-2)+"."+("00"+n.getMilliseconds()).substr(-3),s=this&&this.envIn&&this.envCheck&&this.id,i=["["+a+" "+c+(s?":"+s:"")+"]"+e],f=arguments,u=o.CLog,l=2,v=u.log||console.log;for(r(t)?v=1==t?u.error||console.error:3==t?u.warn||console.warn:v:l=1;l<f.length;l++)i.push(f[l]);A?v&&v("[IsLoser]"+i[0],1<i.length?i:""):v.apply(console,i)}};var T=function(){o.CLog.apply(this,arguments)},A=!0;try{A=!console.log.apply}catch(e){}var R=0;function O(e){var t=this;t.id=++R,P();var a={type:"mp3",onProcess:n};for(var o in e)a[o]=e[o];var s=(t.set=a)[v],i=a[l];(s&&!r(s)||i&&!r(i))&&t.CLog(G.G("IllegalArgs-1",[G("VtS4::{1}\u548c{2}\u5fc5\u987b\u662f\u6570\u503c",0,l,v)]),1,e),a[v]=+s||16,a[l]=+i||16e3,t.state=0,t._S=9,t.Sync={O:9,C:9}}o.Sync={O:9,C:9},o.prototype=O.prototype={CLog:T,_streamStore:function(){return this.set.sourceStream?this:o},_streamGet:function(){return this._streamStore().Stream},_streamCtx:function(){var e=this._streamGet();return e&&e._c},open:function(e,r){var c=this,u=c.set,v=c._streamStore(),h=0;e=e||n;var g=function(e,t){t=!!t,c.CLog(G("5tWi::\u5f55\u97f3open\u5931\u8d25\uff1a")+e+",isUserNotAllow:"+t,1),h&&o.CloseNewCtx(h),r&&r(e,t)};c._streamTag=f;var d=function(){c.CLog("open ok, id:"+c.id+" stream:"+c._streamTag),e(),c._SO=0},m=v.Sync,C=++m.O,y=m.C;if(c._O=c._O_=C,c._SO=c._S,t){var w=c.envCheck({envName:"H5",canProcess:!0});if(w)g(G("A5bm::\u4e0d\u80fd\u5f55\u97f3\uff1a")+w);else{var S,x=function(){(S=u.runningContext)||(S=h=o.GetContext(!0))};if(u.sourceStream){if(c._streamTag="set.sourceStream",!o.GetContext())return void g(G("1iU7::\u4e0d\u652f\u6301\u6b64\u6d4f\u89c8\u5668\u4ece\u6d41\u4e2d\u83b7\u53d6\u5f55\u97f3"));x(),M(v);var k=c.Stream=u.sourceStream;k._c=S,k._RC=u.runningContext,k._call={};try{b(v)}catch(e){return M(v),void g(G("BTW2::\u4ece\u6d41\u4e2d\u6253\u5f00\u5f55\u97f3\u5931\u8d25\uff1a")+e.message)}d()}else{var I=function(e,t){try{window.top.a}catch(e){return void g(G("Nclz::\u65e0\u6743\u5f55\u97f3(\u8de8\u57df\uff0c\u8bf7\u5c1d\u8bd5\u7ed9iframe\u6dfb\u52a0\u9ea6\u514b\u98ce\u8bbf\u95ee\u7b56\u7565\uff0c\u5982{1})",0,'allow="camera;microphone"'))}L(1,e)&&(/Found/i.test(e)?g(t+G("jBa9::\uff0c\u65e0\u53ef\u7528\u9ea6\u514b\u98ce")):g(t))},L=function(e,t){if(/Permission|Allow/i.test(t))e&&g(G("gyO5::\u7528\u6237\u62d2\u7edd\u4e86\u5f55\u97f3\u6743\u9650"),!0);else{if(!1!==window.isSecureContext)return 1;e&&g(G("oWNo::\u6d4f\u89c8\u5668\u7981\u6b62\u4e0d\u5b89\u5168\u9875\u9762\u5f55\u97f3\uff0c\u53ef\u5f00\u542fhttps\u89e3\u51b3"))}};if(o.IsOpen())d();else if(o.Support()){x();var T,A,R=function(e){setTimeout((function(){e._call={};var t=o.Stream;t&&(M(),e._call=t._call),(o.Stream=e)._c=S,e._RC=u.runningContext,function(){if(y!=m.C||!c._O){var e=G("dFm8::open\u88ab\u53d6\u6d88");return C==m.O?c.close():e=G("VtJO::open\u88ab\u4e2d\u65ad"),g(e),!0}}()||(o.IsOpen()?(t&&c.CLog(G("upb8::\u53d1\u73b0\u540c\u65f6\u591a\u6b21\u8c03\u7528open"),1),b(v),d()):g(G("Q1GA::\u5f55\u97f3\u529f\u80fd\u65e0\u6548\uff1a\u65e0\u97f3\u9891\u6d41")))}),100)},O=function(e){var t=e.name||e.message||e.code+":"+e,n="";1==D&&L(0,t)&&(n=G("KxE2::\uff0c\u5c06\u5c1d\u8bd5\u7981\u7528\u56de\u58f0\u6d88\u9664\u540e\u91cd\u8bd5"));var r=G("xEQR::\u8bf7\u6c42\u5f55\u97f3\u6743\u9650\u9519\u8bef"),a=G("bDOG::\u65e0\u6cd5\u5f55\u97f3\uff1a");c.CLog(r+n+"|"+e,n||A?3:1,e),n?(T=t,A=e,E(1)):A?(c.CLog(r+"|"+A,1,A),I(T,a+A)):I(t,a+e)},D=0,E=function(e){D++;var t="audioTrackSet",n=JSON.parse(a(u[t]||!0));c.CLog("open... "+D+" "+t+":"+a(n)),e&&("object"!=typeof n&&(n={}),n.autoGainControl=!1,n.echoCancellation=!1,n.noiseSuppression=!1),n[l]&&c.CLog(G("IjL3::\u6ce8\u610f\uff1a\u5df2\u914d\u7f6e{1}\u53c2\u6570\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u6d4f\u89c8\u5668\u4e0d\u80fd\u6b63\u786e\u9009\u7528\u9ea6\u514b\u98ce\u3001\u79fb\u52a8\u7aef\u65e0\u6cd5\u542f\u7528\u56de\u58f0\u6d88\u9664\u7b49\u73b0\u8c61",0,t+"."+l),3);var r={audio:n,video:u.videoTrackSet||!1};try{var v=o.Scope[f](r,R,O)}catch(e){c.CLog(f,3,e),r={audio:!0,video:!1},v=o.Scope[f](r,R,O)}c.CLog(f+"("+a(r)+") "+_(S)+G("RiWe::\uff0c\u672a\u914d\u7f6e {1} \u65f6\u6d4f\u89c8\u5668\u53ef\u80fd\u4f1a\u81ea\u52a8\u542f\u7528\u56de\u58f0\u6d88\u9664\uff0c\u79fb\u52a8\u7aef\u672a\u7981\u7528\u56de\u58f0\u6d88\u9664\u65f6\u53ef\u80fd\u4f1a\u964d\u4f4e\u7cfb\u7edf\u64ad\u653e\u97f3\u91cf\uff08\u5173\u95ed\u5f55\u97f3\u540e\u53ef\u6062\u590d\uff09\u548c\u4ec5\u63d0\u4f9b16k\u91c7\u6837\u7387\u7684\u97f3\u9891\u6d41\uff08\u4e0d\u9700\u8981\u56de\u58f0\u6d88\u9664\u65f6\u53ef\u660e\u786e\u914d\u7f6e\u6210\u7981\u7528\u6765\u83b7\u5f9748k\u9ad8\u97f3\u8d28\u7684\u6d41\uff09\uff0c\u8bf7\u53c2\u9605\u6587\u6863\u4e2d{2}\u914d\u7f6e",0,"audioTrackSet:{echoCancellation,noiseSuppression,autoGainControl}",t)+"("+i+") LM:"+s+" UA:"+navigator.userAgent),v&&v.then&&v.then(R)[p](O)};E()}else I("",G("COxc::\u6b64\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u5f55\u97f3"))}}}else g(G.G("NonBrowser-1",["open"])+G("EMJq::\uff0c\u53ef\u5c1d\u8bd5\u4f7f\u7528RecordApp\u89e3\u51b3\u65b9\u6848")+"("+i+"/tree/master/app-support-sample)")},close:function(e){e=e||n;var t=this,r=t._streamStore();t._stop();var a=" stream:"+t._streamTag,o=r.Sync;if(t._O=0,t._O_!=o.O)return t.CLog(G("hWVz::close\u88ab\u5ffd\u7565\uff08\u56e0\u4e3a\u540c\u65f6open\u4e86\u591a\u4e2arec\uff0c\u53ea\u6709\u6700\u540e\u4e00\u4e2a\u4f1a\u771f\u6b63close\uff09")+a,3),void e();o.C++,M(r),t.CLog("close,"+a),e()},mock:function(e,t){var n=this;return n._stop(),n.isMock=1,n.mockEnvInfo=null,n.buffers=[e],n.recSize=e.length,n._setSrcSR(t),n._streamTag="mock",n},_setSrcSR:function(e){var t=this.set,n=t[l];e<n?t[l]=e:n=0,this[u]=e,this.CLog(u+": "+e+" set."+l+": "+t[l]+(n?" "+G("UHvm::\u5ffd\u7565")+": "+n:""),n?3:0)},envCheck:function(e){var t,n=this.set,r="CPU_BE";if(t||o[r]||"function"!=typeof Int8Array||new Int8Array(new Int32Array([1]).buffer)[0]||(P(r),t=G("Essp::\u4e0d\u652f\u6301{1}\u67b6\u6784",0,r)),!t){var a=n.type,s=this[a+"_envCheck"];n.takeoffEncodeChunk&&(s?e.canProcess||(t=G("7uMV::{1}\u73af\u5883\u4e0d\u652f\u6301\u5b9e\u65f6\u5904\u7406",0,e.envName)):t=G("2XBl::{1}\u7c7b\u578b\u4e0d\u652f\u6301\u8bbe\u7f6etakeoffEncodeChunk",0,a)+(this[a]?"":G("LG7e::(\u672a\u52a0\u8f7d\u7f16\u7801\u5668)"))),!t&&s&&(t=this[a+"_envCheck"](e,n))}return t||""},envStart:function(e,t){var n=this,r=n.set;if(n.isMock=e?1:0,n.mockEnvInfo=e,n.buffers=[],n.recSize=0,e&&(n._streamTag="env$"+e.envName),n.state=1,n.envInLast=0,n.envInFirst=0,n.envInFix=0,n.envInFixTs=[],n._setSrcSR(t),n.engineCtx=0,n[r.type+"_start"]){var a=n.engineCtx=n[r.type+"_start"](r);a&&(a.pcmDatas=[],a.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(e,t){var n=this,r=n.set,a=n.engineCtx;if(1==n.state){var s=n[u],i=e.length,c=o.PowerLevel(t,i),f=n.buffers,v=f.length;f.push(e);var p=f,h=v,g=Date.now(),d=Math.round(i/s*1e3);n.envInLast=g,1==n.buffers.length&&(n.envInFirst=g-d);var m=n.envInFixTs;m.splice(0,0,{t:g,d:d});for(var C=g,_=0,y=0;y<m.length;y++){var w=m[y];if(3e3<g-w.t){m.length=y;break}C=w.t,_+=w.d}var b=m[1],S=g-C;if(S/3<S-_&&(b&&1e3<S||6<=m.length)){var x=g-b.t-d;if(d/5<x){var k=!r.disableEnvInFix;if(n.CLog("["+g+"]"+F.get(G(k?"4Kfd::\u8865\u507f{1}ms":"bM5i::\u672a\u8865\u507f{1}ms",1),[x]),3),n.envInFix+=x,k){var M=new Int16Array(x*s/1e3);i+=M.length,f.push(M)}}}var I=n.recSize,L=i,T=I+L;if(n.recSize=T,a){var A=o.SampleData(f,s,r[l],a.chunkInfo);a.chunkInfo=A,T=(I=a.pcmSize)+(L=A.data.length),a.pcmSize=T,f=a.pcmDatas,v=f.length,f.push(A.data),s=A[l]}var R=Math.round(T/s*1e3),O=f.length,D=p.length,E=function(){for(var e=U?0:-L,t=null==f[0],o=v;o<O;o++){var s=f[o];null==s?t=1:(e+=s.length,a&&s.length&&n[r.type+"_encode"](a,s))}if(t&&a){o=h;for(p[0]&&(o=0);o<D;o++)p[o]=null}t&&(e=U?L:0,f[0]=null),a?a.pcmSize+=e:n.recSize+=e},U=0,z="rec.set.onProcess";try{U=!0===(U=r.onProcess(f,c,R,s,v,E))}catch(e){console.error(z+G("gFUF::\u56de\u8c03\u51fa\u9519\u662f\u4e0d\u5141\u8bb8\u7684\uff0c\u9700\u4fdd\u8bc1\u4e0d\u4f1a\u629b\u5f02\u5e38"),e)}var N=Date.now()-g;if(10<N&&1e3<n.envInFirst-g&&n.CLog(z+G("2ghS::\u4f4e\u6027\u80fd\uff0c\u8017\u65f6{1}ms",0,N),3),U){var P=0;for(y=v;y<O;y++)null==f[y]?P=1:f[y]=new Int16Array(0);P?n.CLog(G("ufqH::\u672a\u8fdb\u5165\u5f02\u6b65\u524d\u4e0d\u80fd\u6e05\u9664buffers"),3):a?a.pcmSize-=L:n.recSize-=L}else E()}else n.state||n.CLog("envIn at state=0",3)},start:function(){var e=this,t=1;if(e.set.sourceStream?e.Stream||(t=0):o.IsOpen()||(t=0),t){var n=e._streamCtx();if(e.CLog(G("kLDN::start \u5f00\u59cb\u5f55\u97f3\uff0c")+_(n)+" stream:"+e._streamTag),e._stop(),e.envStart(null,n[l]),e.state=3,e._SO&&e._SO+1!=e._S)e.CLog(G("Bp2y::start\u88ab\u4e2d\u65ad"),3);else{e._SO=0;var r=function(){3==e.state&&(e.state=1,e.resume())},a="AudioContext resume: ";e._streamGet()._call[e.id]=function(){e.CLog(a+n.state+"|stream ok"),r()},m(n,(function(t){return t&&e.CLog(a+"wait..."),3==e.state}),(function(t){t&&e.CLog(a+n.state),r()}),(function(t){e.CLog(a+n.state+G("upkE::\uff0c\u53ef\u80fd\u65e0\u6cd5\u5f55\u97f3\uff1a")+t,1),r()}))}}else e.CLog(G("6WmN::start\u5931\u8d25\uff1a\u672aopen"),1)},pause:function(){var e=this,t=e._streamGet();e.state&&(e.state=2,e.CLog("pause"),t&&delete t._call[e.id])},resume:function(){var e=this,t=e._streamGet(),n="resume(wait ctx)";if(3==e.state)e.CLog(n);else if(e.state){e.state=1,e.CLog("resume"),e.envResume(),t&&(t._call[e.id]=function(t,n){1==e.state&&e.envIn(t,n)},S(t));var r=e._streamCtx();r&&m(r,(function(t){return t&&e.CLog(n+"..."),1==e.state}),(function(a){a&&e.CLog(n+r.state),S(t)}),(function(t){e.CLog(n+r.state+"[err]"+t,1)}))}},_stop:function(e){var t=this,n=t.set;t.isMock||t._S++,t.state&&(t.pause(),t.state=0),!e&&t[n.type+"_stop"]&&(t[n.type+"_stop"](t.engineCtx),t.engineCtx=0)},stop:function(e,t,n){var r,a=this,f=a.set,v=a.envInLast-a.envInFirst,p=v&&a.buffers.length;a.CLog(G("Xq4s::stop \u548cstart\u65f6\u5dee:")+(v?v+"ms "+G("3CQP::\u8865\u507f:")+a.envInFix+"ms envIn:"+p+" fps:"+(p/v*1e3).toFixed(1):"-")+" stream:"+a._streamTag+" ("+i+") LM:"+s);var h=function(){a._stop(),n&&a.close()},g=function(e){a.CLog(G("u8JG::\u7ed3\u675f\u5f55\u97f3\u5931\u8d25\uff1a")+e,1),t&&t(e),h()},d=function(t,n,s){var i="arraybuffer",u="dataType",l="DefaultDataType",v=a[u]||o[l]||"blob",p=u+"="+v,d=t instanceof ArrayBuffer,m=0,C=d?t.byteLength:t.size;if(v==i?d||(m=1):"blob"==v?"function"!=typeof Blob?m=G.G("NonBrowser-1",[p])+G("1skY::\uff0c\u8bf7\u8bbe\u7f6e{1}",0,c+"."+l+'="'+i+'"'):(d&&(t=new Blob([t],{type:n})),t instanceof Blob||(m=1),n=t.type||n):m=G.G("NotSupport-1",[p]),a.CLog(G("Wv7l::\u7ed3\u675f\u5f55\u97f3 \u7f16\u7801\u82b1{1}ms \u97f3\u9891\u65f6\u957f{2}ms \u6587\u4ef6\u5927\u5c0f{3}b",0,Date.now()-r,s,C)+" "+p+","+n),m)g(1!=m?m:G("Vkbd::{1}\u7f16\u7801\u5668\u8fd4\u56de\u7684\u4e0d\u662f{2}",0,f.type,v)+", "+p);else{if(f.takeoffEncodeChunk)a.CLog(G("QWnr::\u542f\u7528takeoffEncodeChunk\u540estop\u8fd4\u56de\u7684blob\u957f\u5ea6\u4e3a0\u4e0d\u63d0\u4f9b\u97f3\u9891\u6570\u636e"),3);else if(C<Math.max(50,s/5))return void g(G("Sz2H::\u751f\u6210\u7684{1}\u65e0\u6548",0,f.type));e&&e(t,s,n),h()}};if(!a.isMock){var m=3==a.state;if(!a.state||m)return void g(G("wf9t::\u672a\u5f00\u59cb\u5f55\u97f3")+(m?G("Dl2c::\uff0c\u5f00\u59cb\u5f55\u97f3\u524d\u65e0\u7528\u6237\u4ea4\u4e92\u5bfc\u81f4AudioContext\u672a\u8fd0\u884c"):""))}a._stop(!0);var C=a.recSize;if(C)if(a[f.type]){if(a.isMock){var _=a.envCheck(a.mockEnvInfo||{envName:"mock",canProcess:!1});if(_)return void g(G("AxOH::\u5f55\u97f3\u9519\u8bef\uff1a")+_)}var y=a.engineCtx;if(a[f.type+"_complete"]&&y){var w=Math.round(y.pcmSize/f[l]*1e3);return r=Date.now(),void a[f.type+"_complete"](y,(function(e,t){d(e,t,w)}),g)}if(r=Date.now(),a.buffers[0]){var b=o.SampleData(a.buffers,a[u],f[l]);f[l]=b[l];var S=b.data;w=Math.round(S.length/f[l]*1e3);a.CLog(G("CxeT::\u91c7\u6837:{1} \u82b1:{2}ms",0,C+"->"+S.length,Date.now()-r)),setTimeout((function(){r=Date.now(),a[f.type](S,(function(e,t){d(e,t,w)}),(function(e){g(e)}))}))}else g(G("xkKd::\u97f3\u9891buffers\u88ab\u91ca\u653e"))}else g(G("xGuI::\u672a\u52a0\u8f7d{1}\u7f16\u7801\u5668\uff0c\u8bf7\u5c1d\u8bd5\u5230{2}\u7684src/engine\u5185\u627e\u5230{1}\u7684\u7f16\u7801\u5668\u5e76\u52a0\u8f7d",0,f.type,c));else g(G("Ltz3::\u672a\u91c7\u96c6\u5230\u5f55\u97f3"))}};var D=function(e,t){t.pos||(t.pos=[0],t.tracks={},t.bytes=[]);var n=t.tracks,r=[t.pos[0]],a=function(){t.pos[0]=r[0]},o=t.bytes.length,s=new Uint8Array(o+e.length);if(s.set(t.bytes),s.set(e,o),t.bytes=s,!t._ht){if(z(s,r),N(s,r),!E(z(s,r),[24,83,128,103]))return;for(z(s,r);r[0]<s.length;){var i=z(s,r),c=N(s,r),f=[0],u=0;if(!c)return;if(E(i,[22,84,174,107])){for(;f[0]<c.length;){var v=z(c,f),p=N(c,f),h=[0],g={channels:0,sampleRate:0};if(E(v,[174]))for(;h[0]<p.length;){var d=z(p,h),m=N(p,h),C=[0];if(E(d,[215])){var _=U(m);g.number=_,n[_]=g}else if(E(d,[131])){1==(_=U(m))?g.type="video":2==_?(g.type="audio",u||(t.track0=g),g.idx=u++):g.type="Type-"+_}else if(E(d,[134])){for(var y="",w=0;w<m.length;w++)y+=String.fromCharCode(m[w]);g.codec=y}else if(E(d,[225]))for(;C[0]<m.length;){var b=z(m,C),S=N(m,C);if(E(b,[181])){_=0;var x=new Uint8Array(S.reverse()).buffer;4==S.length?_=new Float32Array(x)[0]:8==S.length?_=new Float64Array(x)[0]:T("WebM Track !Float",1,S),g[l]=Math.round(_)}else E(b,[98,100])?g.bitDepth=U(S):E(b,[159])&&(g.channels=U(S))}}}t._ht=1,T("WebM Tracks",n),a();break}}}var k=t.track0;if(k){var M=k[l];if(t.webmSR=M,16==k.bitDepth&&/FLOAT/i.test(k.codec)&&(k.bitDepth=32,T("WebM 16->32 bit",3)),M<8e3||32!=k.bitDepth||k.channels<1||!/(\b|_)PCM\b/i.test(k.codec))return t.bytes=[],t.bad||T("WebM Track Unexpected",3,t),-(t.bad=1);for(var I=[],L=0;r[0]<s.length;){v=z(s,r);if(!(p=N(s,r)))break;if(E(v,[163])){var A=15&p[0];if(!(g=n[A]))return T("WebM !Track"+A,1,n),-1;if(0===g.idx){var R=new Uint8Array(p.length-4);for(w=4;w<p.length;w++)R[w-4]=p[w];I.push(R),L+=R.length}}a()}if(L){var O=new Uint8Array(s.length-t.pos[0]);O.set(s.subarray(t.pos[0])),t.bytes=O,t.pos[0]=0;R=new Uint8Array(L),w=0;for(var D=0;w<I.length;w++)R.set(I[w],D),D+=I[w].length;x=new Float32Array(R.buffer);if(1<k.channels){var F=[];for(w=0;w<x.length;)F.push(x[w]),w+=k.channels;x=new Float32Array(F)}return x}}},E=function(e,t){if(!e||e.length!=t.length)return!1;if(1==e.length)return e[0]==t[0];for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0},U=function(e){for(var t="",n=0;n<e.length;n++){var r=e[n];t+=(r<16?"0":"")+r.toString(16)}return parseInt(t,16)||0},z=function(e,t,n){var r=t[0];if(!(r>=e.length)){var a=("0000000"+e[r].toString(2)).substr(-8),o=/^(0*1)(\d*)$/.exec(a);if(o){var s=o[1].length,i=[];if(!(r+s>e.length)){for(var c=0;c<s;c++)i[c]=e[r],r++;return n&&(i[0]=parseInt(o[2]||"0",2)),t[0]=r,i}}}},N=function(e,t){var n=z(e,t,1);if(n){var r=U(n),a=t[0],o=[];if(r<2147483647){if(a+r>e.length)return;for(var s=0;s<r;s++)o[s]=e[a],a++}return t[0]=a,o}},F=o.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(e,t){var n=c+".i18n.put: ",r=e.overwrite;r=null==r||r;var a=e.lang;if(!(a=F.alias[a]||a))throw new Error(n+"set.lang?");var o=F.locales[a];o||(o={},F.locales[a]=o);for(var s,i=/^([\w\-]+):/,f=0;f<t.length;f++){var u=t[f];if(s=i.exec(u)){var l=s[1];u=u.substr(l.length+1);!r&&o[l]||(o[l]=u)}else T(n+"'key:'? "+u,3,e)}},get:function(){return F.v_G.apply(null,arguments)},v_G:function(e,t,n){t=t||[],n=n||F.lang,n=F.alias[n]||n;var r=F.locales[n],a=r&&r[e]||"";return a||"zh"==n?(F.lastLang=n,"=Empty"==a?"":a.replace(/\{(\d+)(\!?)\}/g,(function(n,r,o){return n=t[(r=+r||0)-1],(r<1||r>t.length)&&(n="{?}",T("i18n["+e+"] no {"+r+"}: "+a,3)),o?"":n}))):"en"==n?F.v_G(e,t,"zh"):F.v_G(e,t,"en")},$T:function(){return F.v_T.apply(null,arguments)},v_T:function(){for(var e,t=arguments,n="",a=[],o=0,s=c+".i18n.$T:",i=/^([\w\-]*):/,f=0;f<t.length;f++){var u=t[f];if(0==f){if(!(n=(e=i.exec(u))&&e[1]))throw new Error(s+"0 'key:'?");u=u.substr(n.length+1)}if(-1===o)a.push(u);else{if(o)throw new Error(s+" bad args");if(0===u)o=-1;else if(r(u)){if(u<1)throw new Error(s+" bad args");o=u}else{var l=1==f?"en":f?"":"zh";if((e=i.exec(u))&&(l=e[1]||l,u=u.substr(e[1].length+1)),!e||!l)throw new Error(s+f+" 'lang:'?");F.put({lang:l,overwrite:!1},[n+":"+u])}}}return n?0<o?n:F.v_G(n,a):""}},G=F.$T;G.G=F.get,G("NonBrowser-1::\u975e\u6d4f\u89c8\u5668\u73af\u5883\uff0c\u4e0d\u652f\u6301{1}",1),G("IllegalArgs-1::\u53c2\u6570\u9519\u8bef\uff1a{1}",1),G("NeedImport-2::\u8c03\u7528{1}\u9700\u8981\u5148\u5bfc\u5165{2}",2),G("NotSupport-1::\u4e0d\u652f\u6301\uff1a{1}",1),o.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var P=o.Traffic=function(e){if(t){e=e?"/"+c+"/Report/"+e:"";var n=o.TrafficImgUrl;if(n){var r=o.Traffic,a=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],s=a[1]||"http://file/",i=(a[0]||s)+e;if(0==n.indexOf("//")&&(n=/^https:/i.test(i)?"https:"+n:"http:"+n),e&&(n=n+"&cu="+encodeURIComponent(s+e)),!r[i])r[i]=1,(new Image).src=n,T("Traffic Analysis Image: "+(e||c+".TrafficImgUrl="+o.TrafficImgUrl))}}};h&&(T(G("8HO5::\u8986\u76d6\u5bfc\u5165{1}",0,c),1),h.Destroy()),e[c]=o}(o,a),void 0!==(r=function(){return o.Recorder}.call(t,n,t,e))&&(e.exports=r),e.exports&&(e.exports=o.Recorder)}(),function(){var e=("object"==typeof window&&!!window.document?window:Object).Recorder;!function(e,t,n){"use strict";e.prototype.enc_wav={stable:!0,fast:!0,getTestMsg:function(){return n("gPSE::\u652f\u6301\u4f4d\u65708\u4f4d\u300116\u4f4d\uff08\u586b\u5728\u6bd4\u7279\u7387\u91cc\u9762\uff09\uff0c\u91c7\u6837\u7387\u53d6\u503c\u65e0\u9650\u5236\uff1b\u6b64\u7f16\u7801\u5668\u4ec5\u5728pcm\u6570\u636e\u524d\u52a0\u4e86\u4e00\u4e2a44\u5b57\u8282\u7684wav\u5934\uff0c\u7f16\u7801\u51fa\u6765\u768416\u4f4dwav\u6587\u4ef6\u53bb\u6389\u5f00\u5934\u768444\u5b57\u8282\u5373\u53ef\u5f97\u5230pcm\uff08\u6ce8\uff1a\u5176\u4ed6wav\u7f16\u7801\u5668\u53ef\u80fd\u4e0d\u662f44\u5b57\u8282\uff09")}},e.prototype.wav=function(t,r,a){var o=this.set;!function(t){var r=t.bitRate,a=8==r?8:16;r!=a&&e.CLog(n("wyw9::WAV Info: \u4e0d\u652f\u6301{1}\u4f4d\uff0c\u5df2\u66f4\u65b0\u6210{2}\u4f4d",0,r,a),3),t.bitRate=a}(o);var s=t.length,i=o.sampleRate,c=o.bitRate,f=s*(c/8),u=e.wav_header(1,1,i,c,f),l=u.length,v=new Uint8Array(l+f);if(v.set(u),8==c)for(var p=0;p<s;p++){var h=128+(t[p]>>8);v[l++]=h}else(v=new Int16Array(v.buffer)).set(t,l/2);r(v.buffer,"audio/wav")},e.wav_header=function(e,t,n,r,a){var o=1==e?0:2,s=new ArrayBuffer(44+o),i=new DataView(s),c=0,f=function(e){for(var t=0;t<e.length;t++,c++)i.setUint8(c,e.charCodeAt(t))},u=function(e){i.setUint16(c,e,!0),c+=2},l=function(e){i.setUint32(c,e,!0),c+=4};return f("RIFF"),l(36+o+a),f("WAVE"),f("fmt "),l(16+o),u(e),u(t),l(n),l(n*(t*r/8)),u(t*r/8),u(r),1!=e&&u(0),f("data"),l(a),new Uint8Array(s)}}(e,0,e.i18n.$T)}()},82822:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p,speechTextRealTime:()=>g});var r=n(89946),a=n.n(r),o=n(27113),s=n.n(o);n(48996);const i={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let c;const f=new Uint8Array(16);const u=[];for(let d=0;d<256;++d)u.push((d+256).toString(16).slice(1));function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase()}const v=function(e,t,n){if(i.randomUUID&&!t&&!e)return i.randomUUID();const r=(e=e||{}).random??e.rng?.()??function(){if(!c){if("undefined"===typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");c=crypto.getRandomValues.bind(crypto)}return c(f)}();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=r[e];return t}return l(r)},p=async e=>{const{url:t,sampleRate:n,bitRate:r,options:o,onComplete:i}=Object.assign({sampleRate:16e3,bitRate:16},{},e),c=s()({type:"wav",sampleRate:n,bitRate:r});return{start:async()=>(await new Promise(((e,t)=>{c.open(e,t)})),c.start(),{record:c}),stop:async()=>{const e=await new Promise(((e,t)=>{c.stop((t=>{e(new File([t],"audio.wav",{type:"audio/wav"}))}),t)}));return c.close(),i&&i({file:e}),t&&await a().postForm(t,{file:e},o)}}},h=()=>v().replace(/-/g,""),g=async e=>{const{url:t,options:n,getToken:r,getGatewayUrl:o,sampleRate:s,onError:i,onChange:c,onComplete:f}=Object.assign({},{getGatewayUrl:e=>{let{token:t}=e;return`wss://nls-gateway-cn-shanghai.aliyuncs.com/ws/v1?token=${t}`},onChange:e=>{let{message:t}=e;console.log(t)},onError:()=>{},sampleRate:16e3},e),u=h();let l=null;return{start:async()=>{const{token:e,appKey:t}=await r(),n=h(),a=new WebSocket(o({token:e})),f=[],v=[];let p="";await new Promise((e=>{a.addEventListener("open",(()=>{console.log("socket\u94fe\u63a5\u6210\u529f"),a.send(JSON.stringify({header:{message_id:n,task_id:u,namespace:"SpeechTranscriber",name:"StartTranscription",appkey:t},payload:{format:"pcm",sample_rate:16e3,max_sentence_silence:200,enable_intermediate_result:!0,enable_punctuation_prediction:!0,enable_inverse_text_normalization:!0}}))})),a.addEventListener("message",(t=>{const n=JSON.parse(t.data);"TranscriptionStarted"===n.header.name&&e(),"TranscriptionResultChanged"!==n.header.name&&"SentenceEnd"!==n.header.name||(Object.assign(f,{[n.payload.index]:n.payload.result}),p=Object.keys(f).sort(((e,t)=>e-t)).map((e=>f[e])).join(""),c&&c({payload:n.payload,chunks:f,message:p}))}))}));const g=await window.navigator.mediaDevices.getUserMedia({audio:!0}).catch((e=>{throw console.log("\u83b7\u53d6\u9ea6\u514b\u98ce\u6743\u9650\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5"),i("\u83b7\u53d6\u9ea6\u514b\u98ce\u6743\u9650\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u540e\u91cd\u8bd5","NO_MICROPHONE_PERMISSION",e),e})),d=new window.MediaRecorder(g);d.start(1e3);const m=new(window.AudioContext||window.webkitAudioContext)({sampleRate:s}),C=m.createMediaStreamSource(g),_=m.createScriptProcessor(2048,1,1);_.onaudioprocess=function(e){const t=e.inputBuffer.getChannelData(0),n=new Int16Array(t.length);for(let r=0;r<t.length;++r)n[r]=32767*Math.max(-1,Math.min(1,t[r]));a.send(n.buffer)},C.connect(_),_.connect(m.destination);const y=e=>{v.push(e.data)};return d.addEventListener("dataavailable",y),l={ws:a,stream:g,taskId:u,messageId:n,scriptProcessor:_,audioInput:C,audioContext:m,appKey:t,resultChunks:f,chunks:v,message:p,destroy:()=>{a.send(JSON.stringify({header:{message_id:n,task_id:u,namespace:"SpeechTranscriber",name:"StopTranscription",appkey:t}})),d.removeEventListener("dataavailable",y),a.close(),_.disconnect(),C.disconnect(),m.close();(g.getTracks&&g.getTracks()||g.audioTracks||[]).forEach((e=>{e.stop&&e.stop()})),g.stop&&g.stop()}},l},stop:async()=>{if(!l)return;const{taskId:e,messageId:r,chunks:o,destroy:s,message:i}=l,c=await new Promise(((t,n)=>{const a=new File(o,`${e}.wav`,{type:"audio/wav"});f&&f({file:a,taskId:e,messageId:r,message:i,chunks:o}),s(),l=null,t(a)}));return t&&await a().postForm(t,{file:c},n)}}}}}]);
//# sourceMappingURL=2822.7810f270.chunk.js.map