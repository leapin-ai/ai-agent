"use strict";(self.webpackChunk_kne_components_leapin_ai_agent=self.webpackChunk_kne_components_leapin_ai_agent||[]).push([[817],{4198:(e,t,n)=>{n.r(t),n.d(t,{default:()=>te});var r,a=n(3884),o=n.n(a),i=n(7321),l=n.n(i),c=n(8139),d=n.n(c);const s=["title","titleId"];function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(null,arguments)}function m(e,t){let{title:n,titleId:o}=e,i=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,s);return a.createElement("svg",u({viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",ref:t,"aria-labelledby":o},i),n?a.createElement("title",{id:o},n):null,r||(r=a.createElement("path",{d:"M896 480H544.8V128h-65.6v352H128v66.4h351.2V896h65.6V546.4H896z"})))}const p=a.forwardRef(m);n.p;const v=n.p+"static/media/arrow~bbpMpvlG.519685bf38d489d1185c0c556a594e10.svg";var f,h,y,E;const g=["title","titleId"];function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},w.apply(null,arguments)}function b(e,t){let{title:n,titleId:r}=e,o=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,g);return a.createElement("svg",w({viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",ref:t,"aria-labelledby":r},o),n?a.createElement("title",{id:r},n):null,f||(f=a.createElement("path",{d:"M106.666667 213.333333h810.666666v42.666667H106.666667z"})),h||(h=a.createElement("path",{d:"M640 128v42.666667h42.666667V128c0-23.573333-19.093333-42.666667-42.538667-42.666667H383.872A42.496 42.496 0 0 0 341.333333 128v42.666667h42.666667V128h256z"})),y||(y=a.createElement("path",{d:"M213.333333 896V256H170.666667v639.957333C170.666667 919.552 189.653333 938.666667 213.376 938.666667h597.248C834.218667 938.666667 853.333333 919.68 853.333333 895.957333V256h-42.666666v640H213.333333z"})),E||(E=a.createElement("path",{d:"M320 341.333333h42.666667v384h-42.666667zM490.666667 341.333333h42.666666v384h-42.666666zM661.333333 341.333333h42.666667v384h-42.666667z"})))}const N=a.forwardRef(b);n.p;const _={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var D,O=new Uint8Array(16);function k(){if(!D&&!(D="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return D(O)}for(var j=[],M=0;M<256;++M)j.push((M+256).toString(16).slice(1));function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(j[e[t+0]]+j[e[t+1]]+j[e[t+2]]+j[e[t+3]]+"-"+j[e[t+4]]+j[e[t+5]]+"-"+j[e[t+6]]+j[e[t+7]]+"-"+j[e[t+8]]+j[e[t+9]]+"-"+j[e[t+10]]+j[e[t+11]]+j[e[t+12]]+j[e[t+13]]+j[e[t+14]]+j[e[t+15]]).toLowerCase()}const C=function(e,t,n){if(_.randomUUID&&!t&&!e)return _.randomUUID();var r=(e=e||{}).random||(e.rng||k)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return A(r)};var x=n(5544);const I=function(e,t){t=Object.assign({},{defaultValue:"defaultValue",value:"value",onChange:"onChange"},t);var n=(0,a.useRef)(t.value in e),r=(0,a.useState)(e[t.defaultValue]),o=(0,x.A)(r,2),i=o[0],l=o[1],c=(0,a.useRef)(null);return c.current=n.current?e[t.value]:i,[c.current,function(r){for(var a="function"===typeof r?c.current=r(c.current):r,o=arguments.length,i=new Array(o>1?o-1:0),d=1;d<o;d++)i[d-1]=arguments[d];e[t.onChange]&&e[t.onChange].apply(e,[a].concat(i)),n.current||l(a)}]};function R(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}var S={container:"_AIhaC","show-scrollbar":"_qp1e9",content:"_XZmmG","is-scale":"_q6z6A",vertical:"_B4OPa","arrow-line":"_W5dM8","show-arrow":"_0Cmjn","add-node":"_sVaw9","add-node-btn":"_Y4-Yv",dot:"_06DKa",normal:"_59XmF","node-type-popover":"_6Grsl",show:"_DGtHa","action-bar":"_vxlwT","action-scale":"_xd3mP","action-scale-btn":"_IVeCE","action-scale-num":"_c9-Rl","condition-node-container":"_QTtQr","condition-add-btn":"_9Gq3x","condition-node-item-list":"_MlJIV","condition-node-item":"_4TP17","condition-node-item-line":"_Q-b5J","condition-node-item-last-line":"_n1DDB","condition-node-item-link-line":"_l-p-G","condition-node-item-node-wrap":"_MnV8A","condition-node-item-link-cross-line":"_ERDNK","delete-node":"_I73Kt","end-node-container":"_WzQqY","node-container":"_HGnYM","normal-node-content":"_Uf6Nh","normal-node-title":"_-7Pvj","normal-node-data":"_leHgE","normal-node-data-text":"_Kqf3r","normal-node-data-icon":"_-RR3K","node-type-content":"_0sM8G","node-type-group":"_wsgr5","node-type-group-name":"_ka6d9","node-type-list":"_lmTJ8","node-type-item":"_4q38j","normal-node-container":"_vS7Kd","normal-node-wrap":"_FhjH6","normal-node-content-wrap":"_EYYsJ","start-node-container":"_pydi2","start-node-content":"_u41XY","condition-content-title":"_MgJlN","condition-content-title-add-btn":"_X7-fq"};const T=[{id:"startEvent",type:"start",title:"\u5f00\u59cb"},{id:"endEvent",type:"end",title:"\u7ed3\u675f"}],L=[{name:"\u666e\u901a\u8282\u70b9",list:[{type:"normal",name:"\u666e\u901a\u8282\u70b9"}]},{name:"\u5206\u652f\u8282\u70b9",list:[{type:"condition",name:"\u6761\u4ef6\u5206\u652f"}]}],V=(0,a.createContext)({}),{Provider:P,Consumer:H}=V,U=()=>(0,a.useContext)(V),B=e=>{const{scale:t,onChange:n}=Object.assign({},{},e);return o().createElement("div",{className:S["action-bar"]},o().createElement("div",{className:S["action-scale"]},o().createElement("div",{className:S["action-scale-btn"],onClick:()=>{n(t+10)}},o().createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o().createElement("path",{d:"M580.722174 437.990403 580.722174 78.171384 436.794158 78.171384 436.794158 437.990403 76.975139 437.990403 76.975139 581.918419 436.794158 581.918419 436.794158 941.737438 580.722174 941.737438 580.722174 581.918419 940.542216 581.918419 940.542216 437.990403Z"}))),o().createElement("div",{className:S["action-scale-num"]},t.toFixed(0),"%"),o().createElement("div",{className:S["action-scale-btn"],onClick:()=>{n(t-10)}},o().createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},o().createElement("path",{d:"M587.229378 437.990403 580.722174 437.990403 76.975139 437.990403 76.975139 581.918419 580.722174 581.918419 587.229378 581.918419 940.542216 581.918419 940.542216 437.990403Z"})))))},z=e=>{const{showArrow:t}=Object.assign({},{showArrow:!0},e),{vertical:n}=U();return o().createElement("div",{className:d()(S["arrow-line"],{[S["show-arrow"]]:t,[S.vertical]:n})})},Y=e=>{const{onClick:t}=Object.assign({},{},e),{nodeTypeList:n}=U();return o().createElement("div",{className:S["node-type-content"]},(n||L).map(((e,n)=>o().createElement("div",{className:S["node-type-group"],key:n},o().createElement("div",{className:S["node-type-group-name"]},e.name),o().createElement("div",{className:S["node-type-list"]},e.list.map(((e,n)=>o().createElement("div",{className:S["node-type-item"],key:n,onClick:n=>{t&&t(e)}},e.name))))))))},G=e=>{const{nodeData:t,btnType:n}=Object.assign({},{btnType:"normal"},e),[r,i]=(0,a.useState)(""),[l,c]=(0,a.useState)(!1),[s,u]=(0,a.useState)({}),m=(0,a.useRef)(null),{readonly:v,vertical:f,emitter:h}=U(),y=(0,a.useMemo)((()=>"normal"===r?r:n||r),[r,n]);return(0,a.useEffect)((()=>{l?(()=>{const e=m.current;if(!e)return;const t=e.offsetWidth,n=e.offsetHeight,{left:r,top:a}=e.getBoundingClientRect(),o=window.innerWidth,i={};i[a+n>window.innerHeight?"bottom":"top"]=0,i[r+t>o?"right":"left"]="42px",u(i)})():setTimeout((()=>{u({left:"42px",top:0})}),300)}),[l]),v?null:o().createElement("div",{className:d()(S["add-node"],{[S.vertical]:f}),onMouseEnter:()=>{i("normal")},onMouseLeave:()=>{i("")}},o().createElement("div",{className:d()(S["add-node-btn"],y&&S[y]),onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{c(!1)}},o().createElement(p,null),o().createElement("div",{ref:m,className:d()(S["node-type-popover"],{[S.show]:l}),style:s},o().createElement(Y,{onClick:e=>{let{type:n}=e;h.emit("add-node-type-click",{type:n,nodeData:t}),c(!1)}}))))},X=e=>{const{vertical:t}=U(),{nodeData:n,isMouseEnter:r}=Object.assign({},e);return o().createElement("div",{className:d()(S["start-node-container"],{[S.vertical]:t})},o().createElement("div",{className:S["start-node-content"]},n.title),o().createElement(z,null),o().createElement(G,{nodeData:n,btnType:r?"dot":""}))},q=e=>{const{nodeData:t}=Object.assign({},{},e);return o().createElement("div",{className:S["end-node-container"]},t.title)},F=e=>{const{nodeData:t}=Object.assign({},{},e),{emitter:n}=U();return o().createElement("div",{className:S["normal-node-content"],onClick:()=>{n.emit("node-content-click",{nodeData:t})}},o().createElement("div",{className:S["normal-node-title"]},("function"===typeof t.titleRender?t.titleRender(t):t.title)||""),o().createElement("div",{className:S["normal-node-data"]},o().createElement("div",{className:S["normal-node-data-text"]},t.content||""),o().createElement("img",{src:v,alt:"\u7bad\u5934",className:S["normal-node-data-icon"]})))},K=e=>{const{nodeData:t,isMouseEnter:n}=Object.assign({},{nodeList:null,data:null,isMouseEnter:!1},e),{vertical:r,readonly:a,emitter:i}=U();return o().createElement("div",{className:d()(S["condition-node-container"],{[S.vertical]:r})},!a&&!t.content&&o().createElement("div",{className:d()(S["condition-add-btn"]),onClick:()=>{i.emit("add-condition-branch-click",{nodeData:t})}},"\u6dfb\u52a0\u6761\u4ef6"),t.content&&o().createElement(o().Fragment,null,o().createElement(F,{nodeData:Object.assign({},t,{titleRender:e=>o().createElement("div",{className:S["condition-content-title"]},o().createElement("div",null,e.title),o().createElement("div",null,!a&&o().createElement("div",{className:S["condition-content-title-add-btn"],onClick:t=>{t.stopPropagation(),i.emit("add-condition-branch-click",{nodeData:e})}},"\u6dfb\u52a0\u6761\u4ef6")))})}),o().createElement(z,null)),o().createElement("div",{className:S["condition-node-item-list"]},t.children.map(((e,t)=>o().createElement("div",{key:t,className:S["condition-node-item"]},o().createElement("div",{className:d()(S["condition-node-item-line"],S["condition-node-item-first-line"])}),o().createElement("div",{className:d()(S["condition-node-item-line"],S["condition-node-item-last-line"])}),o().createElement("div",{className:S["condition-node-item-link-line"]}),o().createElement("div",{className:S["condition-node-item-node-wrap"]},(Array.isArray(e)?e:[e]).map((e=>o().createElement(W,{key:e.id,nodeData:e,isMouseEnter:n}))),o().createElement("div",{className:S["condition-node-item-link-cross-line"]})))))),o().createElement(z,null),o().createElement(G,{nodeData:t,btnType:n?"dot":""}))},J=e=>{const{onClick:t}=Object.assign({},{},e);return o().createElement("div",{className:S["delete-node"],onClick:e=>{e.stopPropagation(),t&&t(e)}},o().createElement(N,null))},Q=e=>{const{nodeData:t,isMouseEnter:n}=Object.assign({},{},e),[r,i]=(0,a.useState)(!1),{readonly:l,vertical:c,emitter:s}=U(),u=(0,a.useRef)(null);return o().createElement("div",{className:d()(S["normal-node-container"],{[S.vertical]:c})},o().createElement("div",{className:S["normal-node-wrap"]},o().createElement("div",{className:S["normal-node-content-wrap"],onMouseEnter:()=>{clearTimeout(u.current),i(!0)},onMouseLeave:()=>{u.current=setTimeout((()=>{i(!1)}),200)}},o().createElement(F,{nodeData:t}),r&&!l&&o().createElement(J,{onClick:()=>{s.emit("delete-node-click",{nodeData:t})}})),o().createElement(z,null),o().createElement(G,{nodeData:t,btnType:n?"dot":""}),Array.isArray(t.children)&&t.children.length>0&&t.children.map((e=>o().createElement(W,{key:e.id,nodeData:e,isMouseEnter:n})))))},W=e=>{const{nodeData:t,belongConditionNodeData:n,isMouseEnter:r}=Object.assign({},{},e),[i,l]=(0,a.useState)(!1);return o().createElement("div",{className:S["node-container"],onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)}},(e=>{let{nodeData:t}=e;return"start"===t.type?o().createElement(X,{nodeData:t,isMouseEnter:r||i}):"end"===t.type?o().createElement(q,{nodeData:t}):"condition"===t.type?o().createElement(K,{nodeData:t,isMouseEnter:r||i}):o().createElement(Q,{nodeData:t,isMouseEnter:r||i,belongConditionNodeData:n})})({nodeData:t}))},Z=(e,t)=>{let{currentNodeId:n,node:r,type:a}=t;const o=e=>{if(Array.isArray(e)){const t=e.findIndex((e=>e.id===n));if(t>-1){const n=e.slice(0);if("condition"===n[t].type&&"condition"===a){const e=Object.assign({},n[t]),a=(e.children||[]).slice(0);a.push([r]),e.children=a,n.splice(t,1,e)}else n.splice(t+1,0,r);return n}return e.map((e=>o(e)))}return Object.assign({},e,e.children?{children:o(e.children)}:null)};return o(e)},$=["className"],ee=["readonly","showScrollBar","enableDrag","initFit","vertical","onEditNode","nodeTemplate"],te=e=>{let{className:t}=e,n=R(e,$);const r=Object.assign({},{showScrollBar:!0,enableDrag:!0,initFit:!0,vertical:!1,nodeTemplate:{}},n),{readonly:i,showScrollBar:c,enableDrag:s,initFit:u,vertical:m,onEditNode:p,nodeTemplate:v}=r,f=R(r,ee),[h,y]=I(f),E=Array.isArray(h)&&h.length>0?h:T,[g,w]=(0,a.useState)(100),b=(0,a.useRef)({}),N=(0,a.useRef)(null),_=(0,a.useRef)(null),D=(0,a.useRef)(null);D.current=E;const O=(0,a.useRef)(null);O.current=p;const k=(0,a.useRef)(null);k.current=v;const j=l()({name:"flow-chart"});return(0,a.useEffect)((()=>{if(u){const e=N.current.getBoundingClientRect(),t=e.width/e.height,n=_.current.getBoundingClientRect(),r=n.width/n.height;let a,o;t>r?(o=e.height,a=r*o):(a=e.width,o=a/r),w(parseInt(a/n.width*100));const i=(n.width-e.width)/2,l=(n.height-e.height)/2;N.current.scrollTo(i,l)}}),[u]),(0,a.useEffect)((()=>{j.addListener("add-node-type-click",(e=>{let{type:t,nodeData:n}=e;var r,a,o,i;return"condition"===t?y(Z(D.current,{currentNodeId:n.id,node:Object.assign({},{title:"\u6761\u4ef6\u5206\u652f"},null==(r=k.current)?void 0:r.condition,{id:C(),type:"condition",children:[[Object.assign({},{title:"\u6761\u4ef6",content:"\u6761\u4ef6\u5185\u5bb9"},null==(a=k.current)?void 0:a.branch,{id:C(),type:"branch"})],[Object.assign({},{title:"\u6761\u4ef6",content:"\u6761\u4ef6\u5185\u5bb9"},null==(o=k.current)?void 0:o.branch,{id:C(),type:"branch"})]]})})):"normal"===t?y(Z(D.current,{currentNodeId:n.id,node:Object.assign({},{title:"\u666e\u901a\u8282\u70b9",content:"\u8282\u70b9\u5185\u5bb9"},null==(i=k.current)?void 0:i.normal,{id:C(),type:"normal"})})):void 0})),j.addListener("delete-node-click",(e=>{let{nodeData:t}=e;y(((e,t)=>{let{currentNodeId:n}=t;const r=e=>{if(Array.isArray(e)){const t=e.findIndex((e=>e.id===n));if(t>-1){const n=e.slice(0);return"branch"===n[t].type?[]:(n.splice(t,1),n)}return e.map((e=>r(e))).filter((e=>!("condition"===e.type&&e.children.length<2)))}return Object.assign({},e,e.children?{children:r(e.children).filter((e=>e&&e.length>0))}:null)};return r(e)})(D.current,{currentNodeId:t.id}))})),j.addListener("add-condition-branch-click",(e=>{let{nodeData:t}=e;y(Z(D.current,{currentNodeId:t.id,type:"condition",node:{id:C(),type:"branch",title:"\u6761\u4ef6",content:"\u6761\u4ef6\u5185\u5bb9"}}))})),j.addListener("node-content-click",(e=>{let{nodeData:t}=e;O.current&&O.current({nodeData:t,replaceNode:e=>{y(((e,t)=>{let{node:n}=t;const r=e=>Array.isArray(e)?e.map((e=>r(e))):e.id===n.id?Object.assign({},n,{type:e.type}):e.children?Object.assign(e,{children:r(e.children)}):e;return r(e)})(D.current,{node:e}))}})}));const e=e=>{if(!(b.current.isMousedown&&N.current&&s))return;e.preventDefault();let t=b.current.scrollLeft-(e.clientX-b.current.x),n=b.current.scrollTop-(e.clientY-b.current.y);N.current.scrollTo(t,n)},t=()=>{b.current.isMousedown=!1};return window.addEventListener("mousemove",e,!1),window.addEventListener("mouseup",t,!1),()=>{j.removeAllListeners(),window.removeEventListener("mousemove",e,!1),window.removeEventListener("mouseup",t,!1)}}),[j,s,y]),o().createElement(P,{value:{readonly:i,vertical:m,nodeList:E,emitter:j}},o().createElement("div",{ref:N,className:d()(t,"flow-chart-container",S.container,{[S["show-scrollbar"]]:c}),onMouseDown:e=>{b.current.isMousedown=!0,b.current.x=e.clientX,b.current.y=e.clientY,b.current.scrollLeft=N.current.scrollLeft,b.current.scrollTop=N.current.scrollTop}},o().createElement(B,{scale:g,onChange:w}),o().createElement("div",{ref:_,className:d()("flow-chart-content",S.content,{[S.vertical]:m,[S["is-scale"]]:g<=100}),style:{transform:"scale(".concat(g/100,")")}},E.map((e=>o().createElement(W,{key:e.id,nodeList:E,nodeData:e}))))))}},3145:(e,t,n)=>{function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{A:()=>r})},6369:(e,t,n)=>{function r(e){if(Array.isArray(e))return e}n.d(t,{A:()=>r})},6562:(e,t,n)=>{function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{A:()=>r})},5544:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(6369);var a=n(7800),o=n(6562);function i(e,t){return(0,r.A)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],c=!0,d=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){d=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(d)throw a}}return l}}(e,t)||(0,a.A)(e,t)||(0,o.A)()}},7800:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(3145);function a(e,t){if(e){if("string"==typeof e)return(0,r.A)(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.A)(e,t):void 0}}}}]);
//# sourceMappingURL=817.6e329a9f.chunk.js.map